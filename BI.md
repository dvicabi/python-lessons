# 🧭 תוכן העניינים

1. מנהלות הקורס ומבנה הציון
2. היכרות עם המרצה והקורס
3. מהי בינה עסקית (Business Intelligence – BI)
4. ההבדל בין BI ל־AI
5. תשתיות מחשוב – מהעולם הישן לעולם החדש
6. מחשוב ענן (Cloud Computing)
7. מבנה מערכת BI – שלבים ותהליך העבודה (ETL ו־Data Warehouse)
8. מושגי יסוד חשובים ב־BI
9. כלים ותוכנות בקורס – Power Pivot ו־Tableau
10. מה לזכור לקראת המשך הסמסטר

---

## 1. מנהלות הקורס ומבנה הציון

**חלוקת הציון:**

* 20% תרגילי בית – עבודה אישית, אפשר בשיתוף אך חובה הגשה נפרדת.
* 80% מבחן סופי – במעבדת מחשבים בלבד, עם חומר פתוח.

**מבחן הסיום:**

* חומר פתוח לחלוטין – אין צורך לשנן.
* מבוצע במעבדה (לא ב־Zoom או בטומקס).
* כולל גם שאלות אמריקאיות וגם העלאת קובץ ביצוע בפועל.
* תתקיים סימולציה לפני הבחינה (בערך בשיעור 11).

**נוכחות:** לא חובה. המרצה לא בודקת נוכחות, אך ממליצה להגיע לשיעורים כדי לתרגל.

---

## 2. היכרות עם המרצה והקורס

* **ד"ר מירב מלצמן** – ראש מחלקת מערכות מידע ודאטה במרכז האקדמי רופין.
* מתמחה בשילוב שבין **כלים טכנולוגיים לבין ניתוחים פיננסיים והתנהגותיים**.
* הקורס מתמקד בהבנת **הבסיס של מערכות BI** – לא רק איך משתמשים בהן, אלא *איך הן עובדות מאחורי הקלעים*.
* החל מהשיעור השני עובדים עם תוכנות באופן מעשי.

---

## 3. מהי בינה עסקית (Business Intelligence)

**מטרה:**
להפוך נתונים (Data) לתובנות עסקיות (Business Insights) שמסייעות בקבלת החלטות ניהוליות.

**עיקרי הרעיון:**

* ארגון מייצר כמויות עצומות של נתונים.
* מערכת BI יודעת **לאסוף, לאחד, לנתח ולהציג** את הנתונים כך שיתמכו בהחלטות.
* הדגש בקורס הוא לא על העיצוב הגרפי של דשבורדים, אלא על **ההיגיון והמבנה שמאחורי הניתוח**.

**דוגמה:**
חברת ביטוח רוצה להבין באילו מחוזות יש יותר תביעות.
ב־BI נבנה דוח שמנתח לפי אזור, גיל מבוטח, סוג פוליסה וכו’ – כדי להחליט היכן לשנות תמחור או פרסום.

**הכלים שנשתמש בהם:**

1. **Power Pivot** – הכלי המובנה של Microsoft Excel (גרסת Office 365).
2. **Tableau** – תוכנה חיצונית מתקדמת, רישוי מיוחד לקורס.

---

## 4. ההבדל בין BI ל־AI

| נושא      | BI – Business Intelligence          | AI – Artificial Intelligence            |
| --------- | ----------------------------------- | --------------------------------------- |
| **גישה**  | המשתמש יודע מראש מה הוא רוצה לנתח   | המערכת עצמה מגלה תבניות והקשרים         |
| **שיטה**  | ניתוח נתונים לפי שאלות מוגדרות      | הפעלת אלגוריתמים סטטיסטיים ולמידת מכונה |
| **תוצר**  | דוחות, גרפים, דשבורדים (Dashboards) | תחזיות, זיהוי מגמות, המלצות אוטומטיות   |
| **דוגמה** | “הראה לי ממוצע שכר לפי מחלקה”       | “מצא לי דפוסי עזיבת עובדים”             |

🧠 **דוגמה אמיתית:**
חברת Target האמריקאית גילתה (באמצעות AI) שקונים של חיתולים נוטים לרכוש גם סיגריות.
המסקנה שימשה את מחלקת השיווק לשנות את מיקום המוצרים בחנות – זו דוגמה ל־AI שהפיק תובנה שלא נשאלה מראש.

---

## 5. תשתיות מחשוב – מהעולם הישן לעולם החדש

**העולם הישן:**

* מבוסס על רכיבים פיזיים: CPU, RAM, Hard Disk מכני.
* השיפור הטכנולוגי האט – אין קפיצות משמעותיות במהירות.
* רוב המחשבים עובדים ברצף ליניארי – לא באמת “במקביל”.

**העולם החדש – מחשוב קוונטי (Quantum Computing):**

* מבוסס על תופעת ה־**Superposition** – יכולת של חלקיק להיות בכמה מצבים בו־זמנית.
* המטרה: ביצועים מהירים פי אלפים, חישוב במקביל של מצבים מרובים.
* הפיתוחים כיום בשלב ניסיוני (טכניון, מכון ויצמן, IBM, Google).
* עדיין אין מחשב קוונטי אמיתי, אך התחום מתקרב לשם.

---

## 6. מחשוב ענן (Cloud Computing)

**מה זה?**
שמירה ועיבוד של נתונים ותוכנות בשרתים מרוחקים – במקום על המחשב המקומי.

**דוגמאות יומיומיות:**

* Gmail
* Google Drive / Dropbox
* Office 365
* Tableau Online

**יתרונות:**

* נגישות מכל מקום
* חיסכון במשאבים מקומיים
* מודל תשלום לפי שימוש (Pay-Per-Use)

⚠️ הערה חשובה:
גם כשמשהו “חינמי”, מישהו משלם עליו – לרוב כדי לחשוף את המוצר לשוק.

---

## 7. מבנה מערכת BI – השלבים המרכזיים (ETL)

**תהליך הליבה של כל מערכת BI:**

1. **Extract** – חילוץ נתונים ממערכות שונות (Database, Excel, ERP וכו').
2. **Transform** – טיוב ועיבוד הנתונים:

   * ניקוי שגיאות
   * שינוי פורמטים
   * הוספת עמודות (למשל הפקת יום בשבוע מתוך תאריך)
   * הפרדת ערכים (כמו “שטראוס – קפה נמס” לשני שדות)
3. **Load** – טעינה של הנתונים למחסן נתונים (Data Warehouse).

לאחר מכן מתבצע הניתוח, והנתונים מוצגים למשתמש בדוחות או דשבורדים.

**למה לא לעבוד ישירות על מערכות הארגון?**
כי זה עלול לשתק אותן. דוגמה: סטודנט שהריץ BI על מערכת אוטובוסים וגרם לקריסה כללית.

**לכן:**
ה־BI עובד על **עותק נפרד** של הנתונים – לא על המערכת החיה (Operational System).

---

## 8. מושגי יסוד חשובים ב־BI

* **Data Warehouse (מחסן נתונים):** מאגר מרכזי המאחד נתונים ממערכות שונות לניתוח.
* **Data Mart:** מחסן נתונים ייעודי למחלקה אחת (למשל כספים בלבד).
* **Data Layer:** שלב ההכנה של הנתונים לפני ניתוח.
* **Dashboard:** תצוגה ויזואלית של נתונים (גרפים, מדדים, מפות).
* **KPI (Key Performance Indicator):** מדד ביצוע עיקרי – לדוגמה “רווח גולמי חודשי” או “זמן תגובה ממוצע”.

🧩 **מה לזכור:**
רוב הכוח של BI נמצא **מאחורי הקלעים** – באיכות הנתונים ובאופן שבו הם מוכנים לניתוח, לא רק בעיצוב הגרפים.

---

## 9. כלים ותוכנות בקורס

### 🟢 Power Pivot (Excel)

* חלק אינטגרלי מ־Office 365.
* מאפשר לטעון, לקשר ולנתח טבלאות גדולות.
* נמצא בתפריט:
  **קובץ → אפשרויות → תוספות (Add-Ins) → תוספות COM → Microsoft Power Pivot for Excel.**
* לא קיים ב־MacOS (מייקרוסופט חסמה). חובה לעבוד על Windows או במעבדה.

### 🟣 Tableau

* תוכנת BI מתקדמת וויזואלית.
* נלמד אותה בהמשך הקורס.
* מאפשרת דשבורדים דינמיים ומפות אינטראקטיביות.
* רישוי מיוחד ניתן לסטודנטים דרך המרצה.

---

## 10. מה לזכור

✅ **BI זה לא עיצוב גרפים** – זה ניתוח נתונים מושכל ליצירת תובנות עסקיות.
✅ **לא לגעת במערכות חיות** – תמיד לעבוד על עותק (Data Warehouse).
✅ **ETL הוא הלב של BI** – חילוץ, טיוב וטעינה.
✅ **Power Pivot ו־Tableau** הן רק כלים; ההבנה המושגית חשובה יותר מהממשק.
✅ **בינה מלאכותית (AI)** אינה תחליף ל־BI – היא שכבה משלימה שמוצאת דפוסים שלא נשאלו מראש.
✅ **תרגול מעשי הוא חובה** – אי אפשר להבין BI רק תיאורטית.

---








## 🧭 שיעור 2 – טעינת קבצים ו־ETL ב־Power Query (Excel BI)

### 🎯 מטרת השיעור

לטעון נתונים ממקורות חיצוניים (Excel, CSV, טקסט, Access), לשנות, לסדר וללטב (ETL = Extract, Transform, Load) כדי להכין את הנתונים לניתוח ב־BI.

---

## שלב 1 – הכנת סביבת העבודה

1. **להוריד את כל הקבצים מהמודל (שיעור 2)** – לא לפתוח אותם, רק לשמור ב־Downloads.
2. **לא לעבוד מתוך zip!**
   אם זה נפתח כ־ZIP → לחלץ הכל.
3. **להעביר את הקבצים לתיקייה מסודרת על ה־Desktop** (זה נחשב "השרת של הארגון").
4. לפתוח **Excel חדש וריק** – זה הקובץ שישמש כקובץ ה־BI.
5. לשמור בשם:

   ```
   Lesson_2_Pitaron.xlsx
   ```

   בתוך התיקייה שפתחת.

---

## שלב 2 – הפעלת Power Pivot (BI)

1. בתפריט העליון:

   * קובץ → אפשרויות → תוספות
   * בתחתית: ניהול תוספות COM → בצע
   * לסמן ✔ על **Power Pivot for Excel**
2. יתווסף סרגל חדש: **Power Pivot**
3. בתפריט **Power Pivot → נהל**, נפתח ממשק ה־BI.
   כרגע הוא ריק – נבדוק בהמשך ששם יופיעו הטבלאות שטענו.

---

## שלב 3 – טעינת קבצים ל־Power Query

### הגדרה כללית

כל טעינה מתבצעת כך:

* תפריט **נתונים → קבל נתונים**
* לבחור **ממקור מתאים**: טקסט / CSV / חוברת עבודה / מסד נתונים
* לבחור קובץ
* ללחוץ **ערוך** (ולא "טען"!)
* להיכנס לחלון **Power Query**
* שם נבצע את השלב האחרון: **סגור וטעון ב...**

---

### סוגי טעינה

| סוג טעינה                                | הסבר                                                                                            | שימוש                                |
| ---------------------------------------- | ----------------------------------------------------------------------------------------------- | ------------------------------------ |
| **צור חיבור בלבד (Connection Only)**     | יוצר קישור חי בין הקובץ למודל BI, בלי לטעון את הנתונים לגיליון. כל שינוי בקובץ יתעדכן אוטומטית. | ✅ זה השימוש הנכון במציאות            |
| **טען כטבלה (Table)**                    | מעלה את הנתונים גם לגיליון האקסל וגם ל־BI. מאט את הקובץ ותופס זיכרון.                           | לשימוש במבחן בלבד או כשמבקשים במפורש |
| **עם סימון "אוסף נתונים למודל הנתונים"** | חובה לסמן V! אחרת הנתונים לא ייכנסו ל־BI.                                                       | תמיד לסמן                            |

---

### דוגמה: טעינת קובץ טקסט (Channel.txt)

1. נתונים → קבל נתונים → **מקובץ טקסט/CSV**
2. לבחור את `Channel.txt`
3. לחץ **ערוך** → נפתח חלון Power Query
4. לא נוגעים בכלום בשלב זה
5. לחץ על **החץ ליד "סגור וטעון" → סגור וטעון אל...**
6. בחר:

   * צור חיבור בלבד
   * ✔ אוסף נתונים למודל הנתונים
7. אישור → נוצרה טעינה (Query) בשם הקובץ

**שינוי שם הטבלה**:

* ב־Power Query מצד שמאל → שינוי שם ל־

  ```
  Dim_Channel
  ```

  (Dim = Dimension, מימד ניתוח; בהמשך נבין את ההבדל מול Fact)

---

### טעינת שאר הקבצים

טעון לפי הסוג:

| קובץ              | מקור נתונים                   | שם טבלה ב־BI | סוג טעינה      |
| ----------------- | ----------------------------- | ------------ | -------------- |
| `Channel.txt`     | טקסט/CSV                      | Dim_Channel  | צור חיבור בלבד |
| `Product.csv`     | טקסט/CSV                      | Dim_Product  | צור חיבור בלבד |
| `Sales.xlsx`      | חוברת עבודה                   | Fact_Sales   | צור חיבור בלבד |
| `Employees.accdb` | מסד נתונים → Microsoft Access | Dim_Employee | צור חיבור בלבד |

> הערה: אם יש כמה גיליונות בקובץ Excel – בוחרים כל גיליון בנפרד, לא את כולם יחד.

---

## שלב 4 – בדיקת הטעינה

1. בחלונית הימנית → “שאילתות וחיבורים” (Data → Queries & Connections)
2. כל טבלה שטענו מופיעה שם.
3. לחיצה כפולה על טבלה → נכנסים שוב ל־Power Query.
4. פתיחת Power Pivot → “נהל” → אמור להציג את הטבלאות שכבר עלו.

---

## שלב 5 – תיוב נתונים (Transform)

כעת מתחילים **לטייב את הנתונים (Transform)** – כלומר לנקות, לסדר ולשנות מבנה.

### 5.1 פתיחת טבלת Channel

* דאבל קליק על `Dim_Channel`
  → נפתח Power Query.
* עמודה אחת בלבד עם סולמיות (#).

#### א. פיצול עמודה לפי מפריד

1. סמן את העמודה היחידה.
2. בכרטיסייה **דף הבית** → **פצל עמודה → לפי מפריד**
3. בחר מפריד: `#`
4. לבחור "בכל מופע של המפריד"
5. אישור → נוצרות 4 עמודות.

#### ב. מחיקת עמודות מיותרות

* לחצן ימני על העמודות הלא רלוונטיות → **הסר**
  (הקובץ המקורי לא משתנה!)

#### ג. שינוי שמות העמודות

* דאבל קליק על שם עמודה

  * הראשונה: `ChannelCode`
  * השנייה: `ChannelName`

#### ד. הפיכת אותיות לגדולות

* סמן את `ChannelName`
* בכרטיסייה **המר → תבנית → אותיות ראשיות**
  (או "אותיות גדולות" – בהתאם לנדרש)

#### ה. שמירה

* דף הבית → **סגור וטעון**
* השינויים נשמרים אוטומטית בקובץ ה־BI.

---

### 5.2 פתיחת טבלת Product

דאבל קליק על `Dim_Product`

#### א. מחיקת עמודה

* לחצן ימני → **הסר עמודה**.

#### ב. החלפת ערכים

1. סמן עמודה `ClassName`
2. בכרטיסייה **המר → החלפת ערכים**
3. חפש: `Regular`
   החלף ב־`Classic`
4. אישור.

*(אם רגישות לאותיות – לבדוק “R” גדולה או קטנה!)*

#### ג. הסרת מילה ראשונה מכל מוצר

1. סמן עמודה `ProductName`
2. **המר → פצל עמודה → לפי מפריד**
3. מפריד: רווח (“space”)
4. בחירה: “במופע השמאלי ביותר”
5. מחק את העמודה הראשונה שנוצרה.
6. השאר עמודת שם אחת בשם `ProductName`.

#### ד. מיון לפי מחיר

1. בעמודה `UnitPrice`
2. לחץ על החץ → **מיון עולה** (מהנמוך לגבוה).

#### ה. השארת 50 שורות ראשונות בלבד

* **דף הבית → השאר שורות → שמור על שורות עליונות**
* הקלד: `50` → אישור.

#### ו. שמירה

* דף הבית → סגור וטעון
  → השינויים נשמרים גם ב־BI.

---

### 5.3 הסברים חשובים על Power Query

| פעולה                       | מקום בתפריט                                    | משמעות                                         |
| --------------------------- | ---------------------------------------------- | ---------------------------------------------- |
| **המר (Transform)**         | משנה את העמודה עצמה                            | דורש את המקור                                  |
| **הוסף עמודה (Add Column)** | יוצר עמודה חדשה ומוסיף תוצאה                   | שומר על המקור                                  |
| **שכפל עמודה**              | יוצר עותק לפני שינוי                           | שימושי לפני שינוי משמעותי                      |
| **הסר שורות / שמור שורות**  | מסנן את הנתונים                                | רק ב־Power Query, לא בקובץ המקורי              |
| **חלץ תווים**               | מאפשר להוציא X תווים מהתחלה / סוף / אחרי מפריד | לדוגמה: תווים ראשונים (7)                      |
| **שינוי שם פעולה**          | לחצן ימני על השלבים (בצד ימין) → שינוי שם      | כדי לזכור מה עשינו (“החלפת Regular ב־Classic”) |

---

## שלב 6 – סיום ושמירה

1. **סגור וטעון** אחרי כל טבלה שסיימת.
2. **שמירה באקסל (Ctrl+S)** – חובה! אחרת השינויים לא נשמרים.
3. לבדוק ב־Power Pivot → נהל:
   רק 50 שורות בטבלת Product, Channel מטויבת, וכל ארבע הטבלאות מופיעות.

---

## סיכום מילולי – מה למדנו היום

* טעינת נתונים ממקורות שונים ל־BI
* הבדל בין צור חיבור בלבד ↔ טעינה כטבלה
* מתודות לתיוב נתונים:

  * פיצול לפי מפריד
  * הסרת עמודות
  * החלפת ערכים
  * שינוי שמות עמודות
  * אחידות רישיות (Capitalization)
  * מיון
  * סינון שורות
* עבודה נכונה עם Power Query כשלב ה־ETL של Power BI
* שמירה על קשר חי בין קובץ המקור ל־BI (Connection)
* כל שינוי בקובץ המקורי → מתעדכן אוטומטית ב־BI

---

















# 🎓 שיעור 3 – תיקון קונקשנים וטיוב מתקדם ב־Power Query

## 📋 תוכן עניינים

1. חיבור מחדש של Power Pivot ופתרון בעיות טעינה
2. הבנת בעיית ה־Connection (קובץ לא נמצא)
3. טעינה מחדש של קבצים (Access ו־Excel)
4. פעולות טיוב על תאריכים – שנת לידה, ותק, גיל בתחילת עבודה
5. חישובי זמן ומספרי תאריכים
6. סוף חודש ופעולות על עמודות קיימות
7. מיזוג עמודות (Merge Columns)
8. עמודה מותאמת אישית (Custom Column) – המרת דולר לשקל
9. טעינת נתונים חיצונית מאתר אינטרנט (בנק ישראל)
10. תרגול וסיכום

---

## 1️⃣ הפעלה מחדש של Power Pivot ובדיקת טעינות

* לוודא ש־**Power Pivot** מופעל (File → Options → Add-ins → COM Add-ins → Power Pivot for Excel ✔).
* לפעמים במעבדה התוספים מתאפסים – לוודא שהסרגל פעיל.
* נכנסים ל־**Power Pivot → נהל (Manage)** כדי לבדוק מה נטען מהשיעור הקודם.
* המרצה שואלת: *“כמה טבלאות טענו?”*

  > התשובה: 5 טבלאות (כיוון ש־Dim_Channel נטענה פעמיים — אחת כטבלה ואחת כ־Connection Only).

---

## 2️⃣ מהי בעיית ה־Connection ולמה זה קורה

* כשמופיע סימן קריאה 🔴 בשאילתה, המשמעות היא שהקובץ המקורי לא נמצא.
* Power Query מחפש את הקובץ המקורי לפי הנתיב במחשב שבו הוא נוצר.
* אם פתחנו את הקובץ במחשב אחר – הוא לא ימצא את הנתיב (לדוגמה Desktop של המרצה).
* לכן: למרות שהטבלה קיימת במודל (Power Pivot), אי אפשר לערוך אותה (אין גישה למקור).

📘 **לקח מעשי:**
במציאות הארגונית, הקבצים *לא נמצאים על מחשבים אישיים* אלא על **שרת מרכזי** –
כך הקונקשנים תמיד עובדים. במעבדה, הקונקשן מתנתק ולכן אי אפשר לבצע טיוב.

---

## 3️⃣ טעינה מחדש של הקבצים (Access + Excel)

* כדי לתקן את הבעיה, יש לטעון מחדש את שני הקבצים:

  * **Employees.accdb** → ייקרא `Dim_Employee_2`
  * **Sales.xlsx** → ייקרא `Fact_Sales_2`

### שלבים:

1. נתונים → קבל נתונים → ממסד נתונים → Access Database
2. לבחור את הקובץ → תצוגה מקדימה → **ערוך** (לא טען!)
3. שינוי שם ל־`Dim_Employee_2`
4. סגור וטעון אל...

   * ✔ צור חיבור בלבד
   * ✔ אוסף נתונים למודל הנתונים
5. לוודא שאין סימן קריאה ושניתן לבצע טיוב.

---

## 4️⃣ טיוב עמודות תאריכים

### מטרה:

לנקות את התאריכים בעמודות:

* `BirthDate`
* `HireDate`

### שלבים:

1. דאבל קליק על `Dim_Employee_2` כדי להיכנס ל־Power Query.
2. לבחור את עמודת התאריך.
3. דף הבית → סוג נתונים (Data Type) → **תאריך בלבד (Date)**.
4. לחזור ולבצע גם לעמודה השנייה.
5. סגור וטעון → הנתונים מתעדכנים במודל.

---

## 5️⃣ עמודה חדשה: שנת לידה (Extract Year)

* לא לשנות את העמודה המקורית! יש להוסיף עמודה חדשה.
* מעבר ל־**הוסף עמודה (Add Column)** → תאריך (Date) → שנה (Year).
* תיווצר עמודה חדשה עם השנה בלבד, לדוגמה 1985, 1992 וכו’.
* אפשר לשנות שם ל־`BirthYear`.

📘 **מה לזכור:**
אם כתוב *“להוסיף עמודה”* → הולכים ל־Add Column.
אם כתוב *“לשנות עמודה”* → הולכים ל־Transform.

---

## 6️⃣ חישוב ותק (Tenure)

**מטרה:** לחשב כמה זמן עובד נמצא בארגון.
כלומר ההפרש בין תאריך היום (Today) לתאריך התחלת העבודה (HireDate).

### כך Power Query רואה תאריכים:

* כל תאריך הוא בעצם מספר (מספר הימים שעברו מאז 1.1.1900).
* לדוגמה: 25.07.2025 = 45863.
* לכן ניתן לחשב ביניהם חיסור כמו בין מספרים.

### שלבים:

1. לעמוד על עמודת `HireDate`.
2. הוסף עמודה → תאריך → **גיל (Age)**.

   > זה לא גיל אמיתי – זה חישוב של “הפרש בין היום לבין התאריך הנתון”.
3. מתקבלת עמודה עם הותק בימים → לשנות שם ל־`TenureDays`.
4. לבחור את העמודה הזו → הוסף עמודה → משך (Duration) → **סה"כ שנים**.
5. מתקבלת עמודה נוספת בשם `TenureYears`.

🟩 **תוצאה:**
עכשיו יש לנו גם “ותק בימים” וגם “ותק בשנים”.

---

## 7️⃣ חישוב גיל העובד (Age)

* דומה מאוד לותק, רק שהתאריך הוא `BirthDate`.
* הוסף עמודה → תאריך → **גיל (Age)**.
* לשנות שם ל־`AgeDays` → משך → סה"כ שנים → `AgeYears`.

---

## 8️⃣ חישוב גיל בתחילת עבודה

**מטרה:** לדעת באיזה גיל העובד התחיל לעבוד.

נוסחה רעיונית:

```
גיל בתחילת עבודה = גיל היום - ותק בשנים
```

### שלבים:

1. Add Column → Custom Column (עמודה מותאמת אישית).
2. שם: `StartAge`.
3. נוסחה:

   ```
   [AgeYears] - [TenureYears]
   ```
4. אישור → נוצרת עמודה חדשה עם גיל תחילת עבודה.
5. סגור וטעון.

---

## 9️⃣ תאריך סוף חודש (End of Month)

**מטרה:** להמיר את כל התאריכים בעמודה לסוף החודש.

* אם רוצים להוסיף עמודה → Add Column → Date → **End of Month**.
* אם רוצים להחליף את העמודה המקורית → Transform → Date → End of Month.

📘 **מה לזכור:**
אם לא כתוב “להוסיף עמודה” – מבצעים ב־Transform (דריסה של הקיים).

---

## 🔟 מיזוג עמודות (Merge Columns)

**מטרה:** לאחד את השם הפרטי (`FirstName`) והשם המשפחה (`LastName`) לעמודה אחת.

### שלבים:

1. לסמן את שתי העמודות (עם Ctrl, לפי הסדר הרצוי).
2. Transform → Merge Columns.
3. מפריד: רווח (Space).
4. שם חדש לעמודה: `FullName`.

📘 **מה לזכור:**

* הסדר חשוב! העמודה שסומנה ראשונה מופיעה ראשונה במיזוג.
* לאחר המיזוג – העמודות הקודמות נמחקות.

---

## 11️⃣ עמודה מותאמת אישית – המרת דולר לשקל 💱

**מטרה:** לחשב מחיר בשקלים (`UnitPrice` כפול שער הדולר).

### שלבים:

1. Add Column → Custom Column.
2. שם: `Price_NIS`.
3. נוסחה:

   ```
   [UnitPrice] * 3.341
   ```

   (השער לפי אתר בנק ישראל בזמן השיעור).
4. סגור וטעון.

📘 **הערה חשובה:**
זה חישוב **ידני** – אם השער משתנה, הנתון לא מתעדכן אוטומטית.

---

## 12️⃣ טעינת נתונים מאתר אינטרנט (בנק ישראל)

**מטרה:** ליצור **Connection חי** לנתוני שערי המטבע.

### שלבים:

1. להיכנס לאתר
   👉 [https://www.boi.org.il/he/Markets/ExchangeRates](https://www.boi.org.il/he/Markets/ExchangeRates)
2. להעתיק את כתובת ה־URL.
3. Excel → נתונים → קבל נתונים → מקורות אחרים → **מהאינטרנט**.
4. להדביק את הקישור → אישור.
5. לבחור את הטבלה `Table0` או `Table1` (בהתאם לגרסה – זו עם השערים).
6. ערוך → להשאיר רק את העמודות:

   * סימול
   * שם מטבע
   * שער יציג עדכני
7. לשנות שם הטבלה ל־`Dim_Currency`.
8. סגור וטעון אל... →

   * צור חיבור בלבד
   * ✔ אוסף נתונים למודל הנתונים

📘 **המשמעות:**
הקובץ מתעדכן אוטומטית עם כל שינוי באתר בנק ישראל.

---

## 13️⃣ הוספת עמודה: שער גבייה ללקוחות

**מטרה:** לחשב שער גבייה גבוה ב־0.10 מהשער הרשמי.

### שלבים:

1. פתיחת הטבלה `Dim_Currency`.
2. Add Column → Custom Column.
3. שם: `ClientRate`.
4. נוסחה:

   ```
   [OfficialRate] + 0.1
   ```
5. אישור → נוצרת עמודה חדשה שמתעדכנת יחד עם הטבלה הראשית.

---

## 14️⃣ סיכום השיעור

### מה למדנו:

* איך לפתור בעיית ניתוק קונקשן.
* טעינה מחדש של קבצים ממקורות שונים.
* עבודה מתקדמת עם תאריכים:

  * המרת תאריך לתאריך בלבד
  * חילוץ שנה
  * חישוב גיל, ותק וגיל בתחילת עבודה
  * סוף חודש
* שימוש בעמודה מותאמת אישית (Custom Column).
* חיבור נתונים חיים מאתר אינטרנט (בנק ישראל).
* עקרון חשוב: **כל שינוי בקובץ המקור או באתר → מתעדכן אוטומטית ב־BI.**

---






















# 🎓 שיעור 4 – טעינה מתוך Excel ומודל הכוכב (Power Pivot Relationships)

---

## 🎯 מטרת השיעור

להבין:

1. את ההבדל בין טעינה חיצונית (מ־Access, CSV וכו’) לטעינה מתוך גיליונות Excel עצמם.
2. את סוגי הטעינה (כטבלה / כקישור בלבד / מתוך גיליון).
3. כיצד לבנות **מודל נתונים (Data Model)** ולהכין את הנתונים לקראת ניתוח ב־Power BI.
4. התחלה של מושגי **פקט (Fact)** ו־**דים (Dim)** ומודל הכוכב.

---

## 🧩 שלב 1 – פתיחת הקבצים והכנת סביבת העבודה

* נוריד משיעור 4 שני קבצים:

  * קובץ Excel
  * קובץ Access
* נפתח את **קובץ ה־Excel בלבד**.
* לוודא שתוסף **Power Pivot** מופעל (כמו בשיעור 2–3):

  * קובץ → אפשרויות → תוספות → COM Add-ins → Power Pivot for Excel ✔
* להיכנס ל־Power Pivot → **נהל (Manage)** → לוודא שאין עדיין טבלאות.

---

## 📂 שלב 2 – ריענון מושגים: שני סוגי טעינות

מירב שואלת:

> “מה למדנו עד עכשיו? איך טענו קבצים?”

תשובות בכיתה: דרך **קבל נתונים** → מאקסל, CSV, Access, אינטרנט וכו’.

* שתי שיטות טעינה:

  1. **כטבלה (Table)** –
     מעלה גם לגיליון אקסל וגם ל־BI.
     יש “כפילות” של נתונים, תופס מקום וזיכרון.
  2. **צור חיבור בלבד (Connection Only)** –
     יוצר קישור ישיר ל־BI בלבד (בלי גיליון באקסל).
     זו השיטה המקצועית המקובלת.

* חשוב: ✔ תמיד לסמן **אוסף נתונים למודל הנתונים**, אחרת זה לא עולה ל־BI.

---

## 🧠 שלב 3 – הדגמה מחדש של טעינה חיצונית (Access)

1. נתונים → קבל נתונים → ממסד נתונים → Access Database
2. לבחור את הקובץ
3. לבחור טבלה → **ערוך**
4. שינוי שם (למשל `Dim_Employee_2`)
5. סגור וטעון ב... → צור חיבור בלבד ✔ אוסף נתונים למודל הנתונים
6. לוודא שהטבלה מופיעה ב־Power Pivot.

---

## 🧱 שלב 4 – טעינה כטבלה לעומת קישור בלבד

| סוג טעינה      | מה נוצר באקסל             | מה עולה ל־BI | האם מתעדכן עם קובץ המקור | מיועד ל־                       |
| -------------- | ------------------------- | ------------ | ------------------------ | ------------------------------ |
| כטבלה          | נוצר גיליון חדש עם נתונים | ✅ כן         | ✅ כן                     | תרגילים, מבחן                  |
| צור חיבור בלבד | אין גיליון באקסל          | ✅ כן         | ✅ כן                     | עבודה מקצועית, ארגונים אמיתיים |

💡 אם לא סומנו “אוסף נתונים למודל הנתונים” – הנתונים לא יופיעו ב־BI בכלל.

---

## ⚙️ שלב 5 – טעינה מתוך **אותו קובץ אקסל**

### הרעיון

עד עכשיו טענו *מבחוץ*.
עכשיו נטען **מתוך גיליונות האקסל עצמם** לאותו קובץ – בלי קובץ חיצוני.

> “המקור הוא הגיליונות של האקסל שאני עומדת עליו כרגע.”

היתרון:

* אין סכנת איבוד קונקשנים (לא תלוי במחשב אחר).
* במבחן זה מה שתעשו – כל הנתונים יהיו בגיליונות האקסל עצמם.

---

## 🧩 שלב 6 – הגדרת טבלאות באקסל לפני טעינה

מירב מדגישה:

> “האקסל לא מזהה ‘בליל של תאים’ כטבלה.”

לכן לפני טעינה חייבים להפוך כל טווח נתונים ל־**טבלה אמיתית**.

### פעולה:

1. עמוד בתוך הנתונים
2. לחץ **Ctrl + T**
3. ודא שסומן ✔ על “הטבלה שלי כוללת כותרות”
4. אישור
5. הטבלה מקבלת צבעים וסינון אוטומטי 🔽
6. ברצועת כלים תופיע לשונית **עיצוב טבלה**
7. בשדה “שם טבלה” רשום שם משמעותי (למשל `CurrencyTable`)

📘 טיפ:

* כדי לדעת אם זה טבלה אמיתית –
  ברגע שאתה עומד עליה תראה את הלשונית “כלי טבלאות → עיצוב”.
* אם אין את הלשונית הזאת → זו לא טבלה אמיתית.

---

## 🧮 שלב 7 – טעינה מתוך גיליון אקסל

### שלבים:

1. עמוד בתוך טבלת האקסל (לא מחוץ לה).
2. בתפריט העליון: **נתונים → מתוך טבלה/טווח**.
3. ייפתח Power Query.
4. שנה שם לטבלה (למשל `Fact_Sales`).
5. סגור וטעון ב... →

   * צור חיבור בלבד
   * ✔ אוסף נתונים למודל הנתונים
6. אישור → הטבלה עלתה ל־BI (בלי לפתוח גיליון נוסף).

---

## 💬 שאלת המרצה:

> “למה לא צריך לטעון כטבלה כאן?”

כי **כבר יש טבלת אקסל!**
לא צריך להכפיל אותה.
זו טעינה מתוך הגיליון, ולכן מספיק **קישור בלבד** בין הגיליון ל־BI.

---

## 🔧 שלב 8 – טיוב מהיר מתוך טבלת Excel טעונה

### דוגמה:

להוסיף עמודה חדשה שמציגה UnitPrice חדש גבוה ב־10%.

1. דאבל קליק על השאילתה (`Fact_Sales`).
2. Power Query → **הוסף עמודה → עמודה מותאמת אישית**.
3. שם: `NewUnitPrice`.
4. נוסחה:

   ```
   [UnitPrice] * 1.1
   ```
5. סגור וטעון → השינוי מופיע ב־BI בלבד (לא באקסל).

📘 חשוב:

* שינוי כזה לעולם לא משפיע על הקובץ המקורי.
* הוא מתעדכן רק במודל ה־BI.

---

## 🧾 שלב 9 – צפייה במקורות הנתונים

בחלונית **שאילתות וחיבורים**:

| מצב טעינה                     | מה רואים                 | פרשנות                          |
| ----------------------------- | ------------------------ | ------------------------------- |
| “לגיליון עבודה ולמודל נתונים” | גם גיליון באקסל וגם ב־BI | טעינה כטבלה                     |
| “למודל נתונים בלבד”           | רק ל־BI                  | צור חיבור בלבד                  |
| “אין מקורות נתונים חיצוניים”  | טעינה מתוך האקסל עצמו    | בטוח למבחן – אין איבוד קונקשנים |

---

## 🧠 שלב 10 – מתי משתמשים בכל סוג טעינה

| סוג טעינה       | שימוש במציאות                           | שימוש בבחינה               |
| --------------- | --------------------------------------- | -------------------------- |
| כטבלה           | כמעט אף פעם                             | לפעמים כשנדרשת צפייה באקסל |
| צור חיבור בלבד  | תמיד, בארגונים אמיתיים                  | גם בתרגילי בית             |
| מתוך טבלת Excel | בבחינה – חובה (כדי למנוע שגיאות קונקשן) | ✅ בבחינה בלבד              |

---

## ⚙️ שלב 11 – תרגול עצמאי

לטעון:

1. `Dim_Employee` – כטבלה
2. `Dim_ProductCategory`, `Dim_ProductSubCategory` – כצור חיבור בלבד
3. כל טבלה אחרת מתוך ה־Access – לפי ההוראות
4. כל טבלאות ה־Excel – מתוך טבלה/טווח

🔹 הקפד להוסיף תחילית `Dim_` לכל טבלה שאינה טבלת מכירות.
🔹 רק `Sales` תוגדר כ־`Fact_Sales`.

---

## 🧮 שלב 12 – טיוב נוסף: חישוב רווח (Profit)

ב־`Fact_Sales`:

1. פתח Power Query
2. הוסף עמודה → **עמודה מותאמת אישית**
3. שם: `Profit`
4. נוסחה:

   ```
   ([UnitPrice] - [UnitCost]) * [SalesQuantity]
   ```
5. סגור וטעון → העמודה נוספה ל־BI בלבד.

---

## 🧮 שלב 13 – טיוב נוסף: מחיר יקר / רגיל / זול

ב־`Fact_Sales`:

1. הוסף עמודה → **עמודה מותנית**
2. שם: `PriceType`
3. תנאים:

   | תנאי             | ערך    |
   | ---------------- | ------ |
   | UnitPrice ≥ 1000 | “יקר”  |
   | UnitPrice < 300  | “זול”  |
   | אחרת             | “רגיל” |
4. אישור → סגור וטעון.
5. ב־BI רואים עמודה חדשה עם הערכים “יקר / רגיל / זול”.

📘 אם רוצים לתקן תנאי → לחיצה על גלגל השיניים של “עמודה מותנית”.

---

## 🌟 שלב 14 – מודל הכוכב (Star Schema)

### מה זה

מודל נתונים שבו:

* טבלה אחת מרכזית – **Fact Table** (טבלת עובדות).
* סביבה – טבלאות **Dimension (Dim)** עם פרטים משלימים (מוצרים, לקוחות, עובדים וכו’).

### מבנה:

```
        Dim_Channel
             │
 Dim_Product │
             │
        Fact_Sales
             │
 Dim_Employee│
             │
     Dim_Promotion
```

---

## 🔗 שלב 15 – יצירת קשרי גומלין (Relationships)

### מעבר לתצוגת דיאגרמה:

* Power Pivot → **נהל → תצוגת דיאגרמה**
* גרור את הטבלאות, סדר במעגל סביב Fact_Sales (מודל כוכב).

### יצירת קשר:

1. גרור שדה משותף מטבלת Dim לטבלת Fact (למשל `ChannelKey` ↔ `ChannelKey`).
2. שחרר → נוצר קו עם:

   * `1` בצד ה־Dim (טבלת “יחיד”)
   * `*` בצד ה־Fact (טבלת “רבים”)

📘 זה נקרא **קשר 1 לרבים (One-to-Many)**.

---

## 🧩 שלב 16 – סיכום והבנה עיונית

| מושג                | הסבר קצר                                                  |
| ------------------- | --------------------------------------------------------- |
| **Fact Table**      | טבלה מרכזית עם נתוני עסקאות (מכירות, הזמנות, תנועות וכו’) |
| **Dimension Table** | טבלאות מסביב שמספקות הקשרים (לקוחות, מוצרים, זמן וכו’)    |
| **Relationship**    | קישור על בסיס שדה משותף (מפתח)                            |
| **Model כוכב**      | מבנה שבו כל Dim מחובר ישירות ל־Fact אחת מרכזית            |
| **BI Storage**      | “מחסן הנתונים” שנבנה בממשק ה־Power Pivot                  |

---

## 🧭 לסיכום דבריה של מירב

> “במציאות עובדים רק עם טעינה כקישור בלבד.
> בבחינה – נטען מתוך גיליונות האקסל כדי למנוע ניתוקי קונקשן.
> כל שינוי שעושים ב־BI לא נוגע בקובץ המקורי.
> וכל עוד יש קשרים בין הטבלאות – אפשר לנתח הכל ביחד.”



























# 🎓 שיעור 5 – קשרי גומלין, מפתחות ומודל הכוכב (Star Schema + Snowflake)

---

## 🎯 מטרת השיעור

להבין:

1. את המשמעות של **קשרים בין טבלאות (Relationships)**
2. את סוגי הקשרים (יחיד–לרבים וכו’)
3. מהו **מודל הכוכב (Star Schema)**
4. מה ההבדל בין טבלת **Fact** לטבלאות **Dimension (Dim)**
5. מה עושים כשאין שדה מקשר ישיר – טיפול בפתיתי שלג (Snowflakes)
6. איך לבצע תיקוני טיוב נכונים במפתחות בין טבלאות

---

## 1️⃣ פתיחה וריענון

* מתחילים מהקובץ של **שיעור 4 – הפתרון**.
* כל הטבלאות כבר טעונות בתוך Power Pivot.
* נכנסים ל־**Power Pivot → נהל**.
* עוברים ל־**תצוגת דיאגרמה** – רואים את כל הטבלאות בצורה מוקטנת, רק שמות העמודות.

💡 הטבלאות בירוק = טבלאות Dim
💡 באמצע – `Fact_Sales` = טבלת העובדות (המרכזית לניתוחי מכירות)

---

## 2️⃣ מה זה קשר גומלין (Relationship)

* כדי לנתח נתונים מכל הטבלאות ביחד, חייבים שהן יהיו **מקושרות**.
* בלי קשרי גומלין – כל טבלה מנותקת, אפשר לנתח רק אותה עצמה.
* בביג דאטה וב־BI הרעיון הוא לנתח הכול **יחד**, ולכן חייבים קשרים נכונים.

---

## 3️⃣ סוגי קשרים בין טבלאות

| סוג הקשר         | הסבר                              | שימוש ב־BI         |
| ---------------- | --------------------------------- | ------------------ |
| 1:1 (יחיד ליחיד) | נדיר, כמעט לא נלמד בקורס          | ❌                  |
| N:N (רבים לרבים) | קיים בעולם האמיתי אבל לא נלמד כאן | ❌                  |
| 1:N (יחיד לרבים) | זהו הקשר הנפוץ ביותר במערכות BI   | ✅ נלמד ומשתמשים בו |

💡 הסימון בתצוגת הדיאגרמה:

* `1` בצד של ה־Dim (חד ערכי)
* `*` בצד של ה־Fact (רבים)

---

## 4️⃣ דוגמה בסיסית – קשר ChannelKey

**מטרה:** להבין מה המשמעות של "יחיד לרבים".

* טבלת `Dim_Channel` מכילה את ערוצי השיווק:

  * חנות
  * אונליין
  * קטלוג
  * שותפים וכו’

* לכל ערוץ יש **ChannelKey** חד־חד ערכי (1, 2, 3, 4)

* בטבלת `Fact_Sales` אותו ChannelKey מופיע שוב ושוב בכל שורת מכירה.
  → לכן שם זה “הרבים”.

📘 **מסקנה:**

* בטבלת Dim – הערך מופיע פעם אחת בלבד → צד ה־1
* בטבלת Fact – אותו ערך חוזר הרבה פעמים → צד ה־*
* הקשר נוצר על בסיס **שדה זהה בתוכן**, לא רק בשם.

---

## 5️⃣ איך יוצרים קשר בפועל

1. תצוגת דיאגרמה
2. גרירה: מהשדה בטבלת Dim → אל השדה בטבלת Fact (או להפך, לא משנה).
3. הוא יוצר קו אוטומטי עם `1` בצד ה־Dim ו־`*` בצד ה־Fact.
4. אם לא כך – יש בעיה במבנה הנתונים (לרוב כפילויות או טעות בתוכן).

💡 התוכנה בודקת את **התוכן**, לא את כיוון הגרירה.
אם בצד אחד הנתונים חד־חד ערכיים – זה הצד של ה־1.

---

## 6️⃣ הגדרה: מפתח (Key)

* שדה **חד־חד ערכי** בטבלה, שמזהה כל רשומה בצורה ייחודית.
* לדוגמה: `EmployeeID`, `StoreKey`, `ChannelKey`.
* בטבלת העובדים – כל עובד מופיע פעם אחת בלבד.
* בטבלת המכירות – אותו עובד יכול להופיע הרבה פעמים (בכל מכירה שביצע).

📘 לכן:

* `EmployeeID` ב־Dim_Employee = מפתח (חד ערכי)
* `EmployeeKey` ב־Fact_Sales = צד הרבים

---

## 7️⃣ איך מוחקים קשר

קליק ימני על הקו → “מחק קשר” → אישור.

---

## 8️⃣ קונספט חשוב – מודל הכוכב (Star Schema)

* יש **טבלה מרכזית אחת** (Fact_Sales).
* סביבה כמה טבלאות Dim (Channel, Product, Store, Employee וכו’).
* כל טבלת Dim מחוברת ל־Fact דרך שדה משותף.
* אין קשרים **בין** טבלאות ה־Dim עצמן.

```
      Dim_Channel
            │
Dim_Product │
            │
       Fact_Sales
            │
Dim_Store   │
            │
     Dim_Employee
```

💡 כל טבלה שמחוברת לפקט – היא חלק מהכוכב.

---

## 9️⃣ בדיקות לפני יצירת קשר

מרצה מירב הדגישה שוב ושוב:

> ❗ לא מספיק ששמות השדות זהים. חייבים לבדוק שהתוכן זהה.

### דוגמה:

* ב־`Dim_Product` יש ProductKey עם מספרים 1–108
* ב־`Fact_Sales` יש ProductKey עם מספרים 1–108 → תקין ✅
* אם באחת יש אותיות ובשנייה מספרים → שגוי ❌

⚠ Power BI ייצור קשר גם אם זה שגוי בתוכן!
רק הניתוחים אחר כך יהיו ריקים → זו טעות חמורה במודל.

---

## 🔟 דוגמה לבעיה קלאסית – קשר Dim_Employee ↔ Fact_Sales

### המצב:

* ב־Dim_Employee יש `EmployeeID` (ת"ז)
* ב־Fact_Sales יש `Employee` שמכיל:

  ```
  FirstName#LastName#Code#ID
  ```

  כלומר – שדה מורכב ולא חד־חד ערכי.

### הבעיה:

אי אפשר לקשר – כי אין שדות עם תוכן זהה.

---

## 11️⃣ פתרון 1 (לא נכון מקצועית, אך מדגים את הרעיון)

**פתרון טכני:**
לטייב את טבלת `Fact_Sales` ולחלץ מתוך `Employee` את המספר (ת"ז) לעמודה חדשה.
כך נוכל לקשר.

### שלבים:

1. Power Query → פתח את `Fact_Sales`.
2. עמודה → Add Column → Extract → After Delimiter → סולמית (#).
3. שם העמודה החדשה: `EmployeeID`.
4. סגור וטעון → עכשיו ניתן לקשר ל־Dim_Employee.

📘 זה עובד טכנית,
אבל מירב מדגישה:

> ❗ “זה פתרון שגוי עקרונית – בבחינה זה אפס נקודות.”

### למה?

כי **אסור להוסיף עמודות לטבלת Fact**,
בגלל שהיא הכי כבדה במערכת (מיליוני שורות).
כל תוספת פוגעת בביצועים וביעילות.

---

## 12️⃣ פתרון 2 (הנכון והמקצועי)

**לטייב את טבלת ה־Dim** כך שתתאים ל־Fact, ולא הפוך.

### הרעיון:

לבנות בטבלת `Dim_Employee` עמודה חדשה שמכילה את **אותו פורמט בדיוק כמו ב־Fact**:

```
FirstName#LastName#Code#ID
```

### שלבים:

1. פתח את `Dim_Employee` ב־Power Query.
2. Add Column → Custom Column.
3. כתוב:

   ```
   [FirstName] & "#" & [LastName] & "#Code#" & Text.From([EmployeeID])
   ```
4. תן שם לעמודה: `Employee_FactKey`.
5. סגור וטעון.
6. חזור ל־Power Pivot ובצע קשר בין:

   * `Dim_Employee[Employee_FactKey]`
   * `Fact_Sales[Employee]`

📘 עכשיו הקשר **נכון מקצועית**,
ולא מעמיס על טבלת המכירות.

---

## 13️⃣ סיכום ביניים – תיקוני מפתחות

| בעיה                            | דרך התיקון                  | נכון לביצוע ב־BI? |
| ------------------------------- | --------------------------- | ----------------- |
| שדה מקשר שונה בשם אך זהה בתוכן  | אפשר לקשר                   | ✅ תקין            |
| שדה מקשר שונה בתוכן (פורמט אחר) | לטייב את ה־Dim              | ✅ נכון            |
| חסר שדה מקשר                    | ליצור אותו (אם ניתן)        | תלוי במצב         |
| להוסיף עמודה לטבלת Fact         | ❌ אסור (לא יעיל, לא מקצועי) |                   |

---

## 14️⃣ פתיתי שלג (Snowflake Schema)

### הבעיה:

טבלה שאין לה שדה משותף עם ה־Fact,
אבל כן יש לה שדה משותף עם טבלת Dim אחרת.

### דוגמה:

* `Dim_Geography` (נתוני אזורים גיאוגרפיים)
* `Dim_Store` (חנויות)
* רק ב־Store יש שדה `GeographyKey`, לא ב־Fact.

💡 כלומר:
`Dim_Geography` → `Dim_Store` → `Fact_Sales`

---

## 15️⃣ פתרון – טיפול בפתית שלג

### שלב 1 – קישור ראשוני

* בתצוגת דיאגרמה:
  גרור `GeographyKey` מ־`Dim_Geography` אל `GeographyKey` שב־`Dim_Store`.

### שלב 2 – העברת הנתונים ל־Store

* עבור לתצוגת נתונים → עמוד על `Dim_Store`.

* הוסף עמודה חדשה:

  ```DAX
  =RELATED(Dim_Geography[CityName])
  ```

  פונקציה `RELATED()` שואבת נתונים מטבלה מקושרת (כמו `VLOOKUP`).

* עכשיו ב־`Dim_Store` יש עמודה בשם `CityName` שנלקחה מ־`Dim_Geography`.

### שלב 3 – הסתרת הפתית

* תצוגת דיאגרמה → קליק ימני על `Dim_Geography` → **הסתר מכלי לקוח**
  (הטבלה נצבעת באפור).
* כעת המשתמש לא רואה אותה, אבל המידע כבר נשמר ב־`Dim_Store`.

💡 ככה נשאר מודל כוכב “נקי” –
כאילו אין פתית שלג, למרות שהמידע נשמר.

---

## 16️⃣ טיפים חשובים מהמרצה

* **תמיד לבדוק תוכן ולא רק שמות!**
* **לא לקשר Dim ל־Dim** – רק לפקט (אלא אם זה פתית שלג שאחריו מוסתר).
* **לא להוסיף טורים לפקט אם לא חייבים.**
* **תמיד לסגור ולטעון אחרי כל טיוב.**
* **בבחינה:** כל קשר, שדה, או תיקון חייב להיות מוסבר בהיגיון עסקי.

---

## 17️⃣ סיכום עיוני – מבנה המודל

| סוג טבלה            | תפקיד                                  | דוגמה                   |
| ------------------- | -------------------------------------- | ----------------------- |
| **Fact Table**      | טבלת העסקאות – הנתונים המרכזיים לניתוח | Fact_Sales              |
| **Dimension Table** | מאפיינים מסבירים (מי, מה, איפה, מתי)   | Dim_Store, Dim_Employee |
| **Snowflake**       | טבלת עזר שמתחברת ל־Dim                 | Dim_Geography           |
| **Key Field**       | מזהה חד־חד ערכי המשמש לקישור           | StoreKey, EmployeeID    |

---

## 18️⃣ משפטי זהב של מירב

> 🟨 “שדות זהים בשם זה לא מספיק – התוכן קובע.”
> 🟨 “תיקון בפקט יעבוד, אבל הוא טעות מקצועית.”
> 🟨 “מודל כוכב אמיתי – רק אם כל הדימים מחוברים ישירות לפקט.”
> 🟨 “פתית שלג מחברים, שואבים, ומסתירים.”
> 🟨 “בבחינה, אם תטייבו בפקט – זה אפס. אם תטייבו בדימנשן – זה מצוין.”

---





























## 🧭 רשימת נושאים

1. טיפול בפתיתי שלג (Snowflake Handling)
2. שימוש בפונקציית RELATED
3. מודל הכוכב (Star Schema) מול פתיתי שלג
4. הסתרת טבלאות מיותרות
5. יצירת מדדים פשוטים (Basic Measures)
6. יצירת דשבורד (Dashboard) ב־Excel בעזרת Pivot
7. פונקציות עיקריות: `AVERAGE`, `SUM`, `MAX`, `COUNT`, `COUNTROWS`
8. הכנה לתרגיל בית 2

---

## 1. טיפול בפתיתי שלג (Snowflake)

### הסבר כללי

פתית שלג הוא טבלה שלא יכולה להתחבר ישירות לטבלה המרכזית (Fact Table), אלא דרך טבלה אחרת (Dimension).
המטרה היא **לפשט את המודל למודל כוכב** שבו כל הטבלאות מתחברות ישירות לטבלה המרכזית.

### שלבים:

1. לזהות את הטבלאות שאינן מחוברות ישירות ל־Fact.
2. לקשר אותן לטבלה אחרת שכן מקושרת (למשל `DimStore` ↔ `DimGeographic`).
3. להשתמש בקשרים (`Relationships`) כדי לאפשר זרימת נתונים עקיפה.
4. אחרי יצירת הקשר — לקחת את הנתונים הנדרשים בעזרת הפונקציה `RELATED()`.
5. להסתיר את טבלת פתית השלג (כדי לשמור על מודל כוכב פשוט וברור).

---

## 2. פונקציית RELATED

### מה היא עושה:

`RELATED()` מאפשרת להביא עמודה מטבלה אחרת, כל עוד יש **קשר אחד-לרבים** (One-to-Many Relationship) ביניהן.

### צורת כתיבה:

```excel
=RELATED(<table>[<column>])
```

### דוגמה:

אם יש לנו את הטבלה `DimStore` ויש קשר אל `DimGeographic`,
ואנחנו רוצים להביא את שם האזור (`Region`):

```excel
=RELATED('DimGeographic'[Region])
```

### הסבר:

* הפונקציה “מטיילת” דרך הקשר ומחזירה את הערך המתאים לפי השדה המקשר (כמו `GeographyKey`).
* היא יודעת בדיוק מאיפה להביא את הנתון בזכות קשרי הגומלין שנבנו קודם.

### מה לא להביא:

לעולם לא להביא שוב את **השדה המקשר** עצמו — כי הוא כבר קיים בטבלה המקומית.

---

## 3. מודל כוכב (Star Schema)

### מה זה:

* מודל שבו יש **טבלה מרכזית אחת (Fact Table)**,
  וכל שאר הטבלאות (Dimension Tables) מחוברות ישירות אליה.
* זה הופך את הניתוח לפשוט, מהיר וברור.

### למה זה חשוב:

* המשתמש רואה רק טבלאות מרכזיות, לא שרשראות של קשרים.
* אפשר לבצע חיתוכים (Slice & Dice) בקלות מכל טבלה לכל טבלה.

---

## 4. הסתרת טבלאות מיותרות

לא מוחקים טבלאות פתיתי שלג — **רק מסתירים**:

1. לחיצה ימנית על שם הטבלה
2. בחירה ב־“הסתר מכלי לקוח”
3. הטבלה הופכת אפורה (hidden)

כך המשתמש לא רואה אותה, אבל המערכת עדיין משתמשת בה מאחורי הקלעים.

---

## 5. יצירת מדדים פשוטים (Basic Measures)

### עיקרון:

מדד (Measure) הוא **חישוב על נתונים**, שמתבצע תמיד ב־Fact Table בלבד.
הוא נכתב מתחת לקו האפור באזור המדדים.

### איך כותבים מדד:

1. עומדים על טבלת ה־Fact (לדוגמה `FactSales`)
2. בשורת החישובים כותבים:

```
Average Unit Price := AVERAGE('FactSales'[UnitPrice])
```

* שם המדד באנגלית
* נקודותיים (`:`)
* שווה (`=`)
* הפונקציה (כמו `AVERAGE`, `SUM`, `MAX`, `COUNTROWS`)

### דוגמה נוספת:

```
Sum Quantity := SUM('FactSales'[SalesQuantity])
```

### הערה חשובה:

תמיד להשתמש בשם טבלה מלא (`'FactSales'[UnitPrice]`)
ולא בקיצור `[UnitPrice]`, כדי למנוע בלבול אם יש עמודות דומות.

---

## 6. בניית דשבורד (Dashboard) באמצעות Pivot Table

### שלבים:

1. באקסל, מסתירים את כל הגיליונות עם הנתונים → כדי שהמשתמש לא ייגע בהם.
2. נשארים עם גיליון אחד שנקרא “Dashboard”.
3. מתוך Power BI (ה־Data Model Manager), לוחצים על:
   **PivotTable → Existing Worksheet → בוחרים מקום בגיליון Dashboard.**
4. מושכים את המדדים לאזור **Values** ואת שדות החיתוך (כמו Channel, Brand, Class) לאזורי **Rows / Columns / Filters**.

### דוגמה:

* Values → `Average Unit Price`
* Rows → `Brand Name`
* Columns → `Class Name`

### תוצאה:

הטבלה מציגה ממוצע מחיר לכל מותג ולכל סוג מוצר.
ניתוח מיידי — המשתמש רואה הכול מבלי לדעת כלום על המודל.

---

## 7. פונקציות מרכזיות שנלמדו

| פונקציה       | תפקיד                       | דוגמה                             |
| ------------- | --------------------------- | --------------------------------- |
| `AVERAGE()`   | חישוב ממוצע                 | `AVERAGE('FactSales'[UnitPrice])` |
| `SUM()`       | חיבור כולל                  | `SUM('FactSales'[SalesQuantity])` |
| `MAX()`       | ערך מרבי (תאריך אחרון וכו') | `MAX('FactSales'[DateKey])`       |
| `COUNT()`     | ספירת ערכים לא ריקים        | `COUNT('FactSales'[UnitPrice])`   |
| `COUNTROWS()` | ספירת שורות בטבלה           | `COUNTROWS('FactSales')`          |

### הערות של המרצה:

* `COUNTROWS` עדיפה על `COUNT` כדי לוודא שהספירה לא תיפגע אם יש תאים ריקים.
* ב־`COUNTROWS` שמים **שם טבלה**, לא עמודה!
* ב־`COUNT` שמים עמודה מספרית בלבד.
* תמיד ליצור מדדים ב־Fact Table, אף פעם לא בטבלאות Dimension.

---

## 8. גרפים (Charts)

לאחר יצירת טבלת Pivot אפשר להוסיף גרפים:

1. מתוך BI → לחיצה על **PivotChart**
2. בחירה ב־**Existing Worksheet**
3. בחירה בגרף מסוג עמודות / עוגה / קווים וכו’
4. ניתן להוסיף **תוויות נתונים (Data Labels)** להצגת ערכים ישירות על הגרף.

דוגמה:
פילוח כמות המכירות (`Count of Sales`) לפי ערוץ (`Channel Name`) בעוגה תלת-ממדית.

---

## 🧩 מה לזכור

* **טפלו בפתיתי שלג בעזרת `RELATED()`** ואל תשאירו טבלאות מנותקות.
* **השתמשו רק במודל כוכב** — טבלה מרכזית אחת, כל היתר סביבה.
* **אל תשתמשו בקיצורים בעמודות** (תמיד שם מלא של טבלה).
* **CountRows לספירת שורות**, לא Count.
* **מדדים תמיד נבנים ב־Fact Table** ולא במקומות אחרים.
* **תנו שמות משמעותיים למדדים** — זה חוסך בלבול בדשבורד.


---























# 🎓 שיעור 7 – מדדים פשוטים, עמודות מחושבות והקדמה ל־DAX

---

## 🧭 רשימת נושאים

1. חזרה קצרה על מדדים פשוטים (Basic Measures)
2. יצירת ממוצעים לפי יצרן (Manufacturer)
3. ניתוח לפי ערוצי מכירה (Channel)
4. הבנת ההבדל בין עמודה למחושב למדד
5. עמודות מחושבות (Calculated Columns) ב־BI
6. שימוש ב־IF ו־ROUND בתוך BI
7. חישוב ותק עובדים (Seniority)
8. עמודות על הנחות וכמויות בפועל
9. פונקציית AND עם מספר תנאים
10. פתיחה להמרת מטבעות ועלות מכר
11. הכנה לשיעור הבא – פונקציות DAX

---

## 1️⃣ חזרה: מדדים פשוטים

מדדים (Measures) הם החישובים המרכזיים ב־BI.
הם **לא עמודות בטבלה** אלא **תוצאה אחת שמחושבת על כל הנתונים**.

בתרגול:

* יצרנו מדד בשם:

  ```dax
  Average Unit Cost := AVERAGE('FactSales'[UnitCost])
  ```
* לאחר מכן שמנו אותו ב־Pivot Table בדשבורד.
* הוספנו את `Manufacturer` (יצרן) מה־DimProduct לשורות כדי לראות ממוצע עלות לכל יצרן.

💡 **מה לזכור:**
המדד מחושב פעם אחת על כל הנתונים – לא לכל שורה.
הפילוח ("פר יצרן") נעשה רק **בדשבורד**, לא בתוך הנוסחה.

---

## 2️⃣ דוגמה: ממוצע עלות מוצר לפי יצרן

### המטרה:

להציג את ממוצע עלות המוצר (Unit Cost) לפי היצרן (Manufacturer).

### השלבים:

1. עומדים ב־FactSales.
2. יוצרים מדד חדש:

   ```dax
   Avg Unit Cost := AVERAGE('FactSales'[UnitCost])
   ```
3. נכנסים ל־Pivot Table → גוררים את המדד ל־Values.
4. גוררים את `Manufacturer` מה־DimProduct לשורות.

🔹 **תוצאה:** ממוצע העלות של כל יצרן (לדוגמה 146.2, 189.4 וכו’).
🔹 **הסבר של מירב:**

> “אני לא מחשבת חלקי כלום. הממוצע הוא ממוצע כללי, והפילוח נעשה בפיבוט עצמו. לא מערבבים בין חישוב לבין פילוח.”

---

## 3️⃣ מדד שני: סך כל הפריטים שהוחזרו לפי ערוץ מכירה

### המטרה:

לדעת כמה פריטים הוחזרו בכל ערוץ מכירה (Channel).

### השלבים:

1. במדור המדדים של FactSales נכתוב:

   ```dax
   Return Quantity Total := SUM('FactSales'[ReturnQuantity])
   ```
2. בפיבוט:

   * Values → Return Quantity Total
   * Rows → Channel Name (`DimChannel`)

🔹 **התוצאה:**
חלוקה של כלל ההחזרות לפי הערוצים:

| Channel | Returned Items |
| ------- | -------------- |
| Store   | 12,000         |
| Online  | 10,000         |
| Catalog | 8,000          |

---

## 4️⃣ ההבדל בין מדד לעמודה

| נושא           | מדד (Measure)                 | עמודה מחושבת (Calculated Column) |
| -------------- | ----------------------------- | -------------------------------- |
| **מקום ביצוע** | בשורת המדדים (מתחת לקו האפור) | בתוך הטבלה עצמה                  |
| **תוצאה**      | תא אחד לכלל הנתונים           | ערך לכל שורה                     |
| **מטרה**       | ניתוח, סיכום, גרפים           | טיוב נתונים, עיבוד שדה נוסף      |
| **יעילות**     | מהיר, תופס מעט מקום           | איטי, תופס הרבה מקום             |
| **דוגמה**      | `SUM('FactSales'[Quantity])`  | `IF([Price]>=100,"High","Low")`  |

מירב מדגישה:

> “אם אני רוצה תוצאה אחת על כל הדאטה – זה מדד.
> אם אני רוצה טור חדש שמתווסף לטבלה – זו עמודה מחושבת.”

---

## 5️⃣ עמודות מחושבות (Calculated Columns)

עמודות מחושבות נבנות **בתוך ה־BI**, לא בפאוור־קווארי (Power Query).
זו דרך להוסיף חישוב חדש אחרי שכל הנתונים כבר נטענו.

### דוגמה א – Price Category

בטבלת `DimProduct` יש להוסיף עמודה חדשה בשם **Price Category**:

```dax
=IF('DimProduct'[UnitPrice]>=100,"High Price","Low Price")
```

💡 חשוב:

* כל הטקסטים נכתבים במרכאות (" ").
* אם רוצים לכתוב בעברית — קודם סוגרים את המרכאות באנגלית ורק אז כותבים בפנים.
* אחרת הנוסחה “מתבלבלת” בשפות.

---

## 6️⃣ עמודה נוספת: Price Category בעברית

אם רוצים שהתוצאה תופיע בעברית:

```dax
=IF('DimProduct'[UnitPrice]>=100,"מחיר גבוה","מחיר נמוך")
```

מירב מזהירה:

> “אל תעברו שפה באמצע הנוסחה. כתבו קודם את כל המרכאות באנגלית ואז תוסיפו את המילים בפנים.”

---

## 7️⃣ עמודה לחישוב ותק עובדים (Seniority)

בטבלת `DimEmployee` נוסיף עמודה `Seniority` שמחשבת כמה שנים עובד נמצא בארגון.

### דרך מדויקת:

```dax
=(TODAY() - 'DimEmployee'[HireDate]) / 365
```

– TODAY() מחזירה את התאריך הנוכחי
– ההפרש מחושב בימים → מחלקים ב־365 לשנים.

### דרך פשוטה פחות:

```dax
=YEAR(TODAY()) - YEAR('DimEmployee'[HireDate])
```

– מחזיר רק הבדל בשנים שלמות (לא מדויק).

### עיגול:

```dax
=ROUND((TODAY() - 'DimEmployee'[HireDate]) / 365,0)
```

– מעגל לשנה הקרובה (0 = בלי ספרות עשרוניות).

💡 **הבדל בין ROUND לבין עיצוב תצוגה:**
עיצוב בעין לא משנה את הערך האמיתי; ROUND כן.

---

## 8️⃣ עמודות הנחות ומוצרים בפועל (Fact Table)

### דוגמה ג – Return Amount בפועל

אם לקוח החזיר עד 4 פריטים → מקבלים את כולם.
אם החזיר יותר → מקבלים רק 75%.

```dax
=ROUND(
    IF('FactSales'[ReturnQuantity]<=4,
       'FactSales'[ReturnQuantity],
       'FactSales'[ReturnQuantity]*0.75),
0)
```

### דוגמה ד – הנחת כמות (Quantity Discount)

אם לקוח קנה יותר מ־15 יחידות → מקבל 10% הנחה על הכמות.

```dax
=IF('FactSales'[SalesQuantity]>15,
    'FactSales'[SalesQuantity]*0.9,
    'FactSales'[SalesQuantity])
```

---

## 9️⃣ שימוש בפונקציית AND עם שני תנאים

בדוגמה בטבלת `DimStore`:
אם החנות נפתחה לפני 2004 וגם יש בה יותר מ־20 עובדים → קוד 1
אחרת → קוד 2.

```dax
=IF(
    AND(
        YEAR('DimStore'[OpenDate])<=2004,
        'DimStore'[EmployeeCount]>20),
    1,
    2
)
```

* `AND()` מאפשרת לבדוק כמה תנאים במקביל.
* באקסל ניתן גם עשרות קריטריונים; ב־BI רק שניים.

---

## 🔟 פונקציית WEEKDAY

בדוגמה בטבלת `DimStore`:
להוסיף עמודה שמציגה באיזה יום בשבוע נפתחה החנות.

```dax
=WEEKDAY('DimStore'[OpenDate])
```

* 1 = יום ראשון, 7 = שבת.
* אין פונקציה שמחזירה את שם היום (Sunday וכו’) – זה נעשה בפאוור קווארי.

---

## 1️⃣1️⃣ המרת מטבעות ו־Total Cost

מירב מדגימה חישוב של **עלות כוללת בשקלים** לפי שער דולר 3.5:

```dax
= 'FactSales'[UnitCost] * 'FactSales'[SalesQuantity] * 3.5
```

💡 בהמשך (בשיעור הבא) תלמדו איך לקשר לטבלת שערי מטבע חיצונית ולחשב זאת אוטומטית.

---

## 1️⃣2️⃣ הערה חשובה של מירב

> “כל טור שאני מוסיפה מכביד על המערכת.
> במקום להוסיף טורים – עדיף ליצור מדדים.
> מדד זה תא אחד במקום מיליון תאים.
> זו היעילות של BI – חישוב מרוכז אחד במקום חישוב לכל שורה.”

---

## 🧠 סיכום עקרונות מרכזיים

| נושא                               | איך לזכור                                |
| ---------------------------------- | ---------------------------------------- |
| מדד                                | תוצאה אחת על כל הדאטה, מיועד לניתוח      |
| עמודה מחושבת                       | ערך לכל שורה, מיועד לטיוב נתונים         |
| ROUND                              | לעיגול אמיתי, לא רק עיצובי               |
| IF ו־AND                           | לוגיקה ותנאים                            |
| TODAY ו־YEAR                       | תאריכים ודינמיות                         |
| תמיד לעבוד עם שם מלא של טבלה       | `'FactSales'[UnitCost]` ולא `[UnitCost]` |
| במבחן – לבצע בדיוק לפי ניסוח השאלה | אם כתוב "עמודה מחושבת" → אסור לעשות מדד  |

---

## 💬 משפטי זהב של מירב

> 🟨 “מדד זה לא עמודה – אל תתבלבלו.”
> 🟨 “בבחינה אם תעשו את זה ב־Power Query תקבלו אפס.”
> 🟨 “עמודה זה לכל שורה, מדד זה תוצאה אחת.”
> 🟨 “תמיד תעשו Save – BI לא אוהב חוסר סבלנות.”
> 🟨 “במציאות עושים מדדים, במבחן עושים מה שמבקשים.”

---

















# 🎓 שיעור 8 – פונקציות DAX (Data Analysis Expressions)

---

## 🧭 רשימת נושאים

1. חזרה קצרה: למה צריך DAX
2. ההבדל בין עמודה מחושבת למדד מבוסס DAX
3. פונקציות DAX פשוטות – ‎`SUMX`, ‎`AVERAGEX`, ‎`COUNTX`
4. מבנה הפונקציה DAX (Table, Expression)
5. יצירת מדדים מתקדמים – Total Cost, Total Revenue, Profit
6. שימוש ב־`RELATED` בתוך פונקציות DAX
7. דוגמאות מלאות: ‎`SUMX`, ‎`AVERAGEX`, ‎`COUNTROWS`
8. עקרונות סגירת סוגריים, טיפים של מירב
9. תרגול: סעיפים 8–10 (Revenue, Discounts, Profit)
10. הערות למבחן ותרגיל בית 3

---

## 1️⃣ חזרה: למה צריך בכלל DAX

ב־Power BI או Power Pivot באקסל, למדנו לבנות עמודות מחושבות (Calculated Columns)
ולעשות עליהן מדדים פשוטים עם ‎`SUM`, ‎`AVERAGE`, ‎`MAX` וכו’.

אבל — מה קורה כשאין לי את העמודה הזאת בכלל?
נניח שאני רוצה לחשב **Total Cost בשקלים**, ואין לי עמודה כזו בדאטה.

אם הייתי בונה עמודה חדשה לכל מדד, הייתי מסיים עם מאות עמודות, וזה לא הגיוני.
**הפתרון:** להשתמש ב־DAX כדי לחשב את הכל בתא אחד — בלי ליצור עמודה נוספת.

מירב קוראת לזה *“הפטנט של מיקרוסופט”* 🧠
הוא מאפשר לחשב ערכים “על הדרך” בלי להעמיס על הדאטה.

---

## 2️⃣ ההבדל בין עמודה למדד DAX

| מאפיין                 | עמודה מחושבת                  | מדד DAX                                        |
| ---------------------- | ----------------------------- | ---------------------------------------------- |
| **מופיעה בטבלה**       | כן (טור אמיתי)                | לא, חישוב וירטואלי בלבד                        |
| **מחשב על כל שורה**    | כן                            | רק בעת הפעלת המדד                              |
| **שומר ערכים בזיכרון** | כן                            | לא, מחושב בכל רגע לפי הפילוח                   |
| **דוגמה**              | ‎`[UnitPrice]*[Quantity]*3.5` | ‎`SUMX(FactSales, [UnitPrice]*[Quantity]*3.5)` |

מירב מדגישה:

> “אל תייצרו טורים כשלא צריך. BI נבנה על יעילות — חישוב בתא אחד ולא מיליון תאים.”

---

## 3️⃣ מבנה פונקציית DAX

כל פונקציה דקסית (‎`SUMX`, ‎`AVERAGEX`, ‎`COUNTX` וכו’) בנויה ככה:

```dax
=SUMX(<Table>, <Expression>)
```

* **Table** – על איזו טבלה לבצע את החישוב
* **Expression** – מה לחשב בכל שורה בטבלה
  בסוף, הפונקציה מסכמת (או מחשבת ממוצע וכו’) את התוצאה הכוללת.

---

## 4️⃣ דוגמה א: ‎`Total Cost in Shekels`

מירב התחילה מהעמודה שעשינו בעבר:
עלות ליחידה × כמות × שער דולר (3.5).

בשיעור הזה — היא ביטלה את הצורך בעמודה, ויצרה מדד DAX ישיר:

```dax
Total Cost 2 := 
SUMX(
    'FactSales',
    'FactSales'[UnitCost] * 'FactSales'[SalesQuantity] * 3.5
)
```

🔹 **מה קורה כאן מאחורי הקלעים:**

* הפונקציה “מטיילת” על כל שורה בטבלת FactSales,
* מחשבת בכל שורה את העלות בשקלים,
* ובסוף עושה סיכום (SUM) כולל.

⚙️ זה אותו חישוב כמו קודם, רק בלי עמודה — יעיל בהרבה.

---

## 5️⃣ דוגמה ב: ‎`Total Revenue in Shekels`

נחשב את סך ההכנסות ממכירה — ‎`UnitPrice * Quantity * 3.5`
(המחירים בדולרים, רוצים בשקלים)

```dax
Total Revenue := 
SUMX(
    'FactSales',
    'FactSales'[UnitPrice] * 'FactSales'[SalesQuantity] * 3.5
)
```

💬 מירב הסבירה:

> “אם אין עמודה בשם Revenue – זו בדיוק העבודה של DAX.
> הוא בונה אותה רגעית, סוכם, וזורק אותה. חישוב וירטואלי.”

---

## 6️⃣ דוגמה ג: ‎`Profit` (רווח)

במקום שוב לכתוב חישוב שלם, משתמשים במדדים הקיימים:

```dax
Profit := [Total Revenue] - [Total Cost 2]
```

DAX יודע לחשב מדד מתוך מדדים אחרים.
זו צורת עבודה חכמה — לא משכפלים נוסחאות.

---

## 7️⃣ פונקציות DAX עם ‎X בסוף

| פונקציה    | פעולה               | הסבר קצר                     |
| ---------- | ------------------- | ---------------------------- |
| `SUMX`     | סכימה               | מסכמת ביטוי שחושב על כל שורה |
| `AVERAGEX` | ממוצע               | מחשבת ממוצע של ביטוי מחושב   |
| `COUNTX`   | ספירה מותנית        | סופרת רק שורות שעומדות בתנאי |
| `MAXX`     | ערך מרבי מתוך ביטוי | מחזירה ערך מירבי מתוך חישוב  |

### כלל ברזל:

> אם יש לך טור קיים → השתמש ב־`SUM` רגיל.
> אם אין טור ואתה “ממציא” את החישוב תוך כדי → ‎`SUMX`.

---

## 8️⃣ שימוש ב־`RELATED` בתוך DAX

כשאתה מביא נתון **מטבלה אחרת**, חייב להשתמש ב־`RELATED()`.

### דוגמה – ממוצע הכנסות לפי מחיר מכירון (`Recommended Price`)

```dax
Average Income from Product :=
AVERAGEX(
    'FactSales',
    'FactSales'[SalesQuantity] * RELATED('DimProduct'[UnitPrice]) * 3.5
)
```

📘 הסבר:

* הטבלה המרכזית (FactSales) מכילה את המכירות, לא את המחירים.
* `RELATED()` “מטיילת” לטבלת `DimProduct`, מוצאת את המוצר הנכון לפי ה־ProductID,
  ומחזירה את ה־UnitPrice המתאים לשורה הזו.
* כך אפשר לבצע חישוב גם על נתונים ממקורות שונים.

מירב אמרה:

> “בלי RELATED – ה־DAX יתבלבל.
> הוא לא יודע לבד איזו שורה ב־Product שייכת לשורה בפקט.”

---

## 9️⃣ דוגמה ד: Average Income לפי מחירון

```dax
Average Income from Product :=
AVERAGEX(
    'FactSales',
    'FactSales'[SalesQuantity] * RELATED('DimProduct'[UnitPrice]) * 3.5
)
```

⚙️ זהו ממוצע ההכנסות “אילו היינו מוכרים לפי המחירון בלבד”,
ולא לפי המחיר בפועל שבוצע במכירה.

---

## 🔟 דוגמה ה: Promotion Cost (עלות קידום מכירות)

רוצים לחשב כמה כסף החברה “ויתרה עליו” בהנחות –
כלומר סך כל אחוזי ההנחה × מחיר × כמות.

```dax
Promotion Cost :=
SUMX(
    'FactSales',
    'FactSales'[UnitPrice] * 'FactSales'[SalesQuantity] * RELATED('DimPromotion'[DiscountPercent]) * 3.5
)
```

💡 פירוש:

> אם מחיר מכירה 100₪, וההנחה 10%,
> החברה הפסידה 10₪ — זה סכום “עלות קידום המכירות”.

---

## 1️⃣1️⃣ דוגמה ו: ספירת עסקאות לפי חנות

```dax
Count of Sales Transactions :=
COUNTROWS('FactSales')
```

המדד סופר את כל השורות בטבלת FactSales —
כל שורה היא עסקה אחת.
כדי לראות **לפי חנות**, משתמשים בפיבוט / דשבורד:

* Rows → StoreName / StoreKey
* Values → Count of Sales Transactions

הפילוח נעשה *בדשבורד*, לא בתוך הנוסחה.

---

## 1️⃣2️⃣ דוגמה מתקדמת: פדיון בטיולים (מתוך תרגיל 8)

הפדיון (Revenue) = סכום של כל התשלומים של מבוגרים + ילדים.

### נוסחת DAX:

```dax
Revenue := 
SUMX(
    'FactTrips',
    ('FactTrips'[AdultNumber] * 'FactTrips'[CostPerPerson]) +
    ('FactTrips'[ChildrenNumber] * 'FactTrips'[CostPerPerson] * 0.6)
)
```

* מבוגרים משלמים מחיר מלא.
* ילדים משלמים רק ‎60% מהעלות למבוגר.
* אין הנחות אחרות.

---

## 1️⃣3️⃣ דוגמה נוספת: פדיון לאחר הנחה ללקוחות (Traveler Discount)

```dax
Revenue After Discount :=
SUMX(
    'FactTrips',
    'FactTrips'[CostPerPerson] * 'FactTrips'[AdultNumber] * (1 - RELATED('DimTravelers'[Discount]))
)
```

* `RELATED()` מושך את אחוז ההנחה מטבלת הלקוחות.
* `(1 - Discount)` מוודא שהמחיר מחושב אחרי הנחה.
* סוגריים חשובים! אחרת BI לא ידע מה לחשב קודם.

---

## 1️⃣4️⃣ דוגמה: רווח (Profit)

```dax
Profit :=
[Revenue After Discount] - [Total Cost]
```

אם רוצים לכלול גם הוצאות טיול (מדריך, תחבורה וכו’):

```dax
Profit :=
[Revenue After Discount] - RELATED('DimTrips'[CostOfTrip])
```

---

## 🧩 עקרונות חשובים לזכור

| כלל                                | הסבר                          |
| ---------------------------------- | ----------------------------- |
| כל פונקציית DAX כוללת טבלה ו־ביטוי | ‎`SUMX(Table, Expression)`    |
| סוגריים חשובים מאוד                | לכל פונקציה יש סוגריים נפרדים |
| כל שדה מטבלה אחרת → ‎`RELATED()`   | אחרת לא יעבוד                 |
| סדר פעולות מתמטי רגיל              | כפל, חיסור, חיבור             |
| תמיד לתת שמות ברורים למדדים        | כדי לדעת מאיפה בא כל חישוב    |
| דשבורד = המקום לפילוחים            | לא בתוך הנוסחה                |

---

## 🧠 מירב אומרת

> 🟨 “DAX זה לא קסם — זה פשוט חישוב וירטואלי.”
> 🟨 “אל תבנו טורים אם אפשר לעשות מדד.”
> 🟨 “במבחן — אם כתוב *חשב מדד*, אסור לבנות טור.”
> 🟨 “RELATE זה הקסם שמחבר עולמות.”
> 🟨 “תבדקו תמיד סוגריים — BI לא סוגר בשבילכם כמו אקסל.”

---

## 📚 תרגיל בית 3 – דגשים

* סעיפים 1–7 → מדדים פשוטים (`SUM`, `COUNT`, `MAX`, `MIN`)
* סעיפים 8–11 → מדדים מבוססי DAX (`SUMX`, `AVERAGEX`)
* סעיף 12 → יוסבר בהמשך, לא לבצע עדיין
* לבנות דשבורד עם שתי טבלאות Pivot ושני גרפים
* לא להוסיף עמודות חדשות — רק מדדים
* כל חישוב בשקלים → ‎`*3.5`

---


















מושלם דביר 💪
הנה סיכום מלא של **שיעור 9 – הכרות עם Tableau ויצירת ויזואליזציות מתקדמות**,
נכתב בדיוק בסגנון של מירב בכיתה — כולל הדרך שבה היא מסבירה, ההקשרים, הדוגמאות וההערות שלה לסטודנטים.
המטרה היא שתרגיש שאתה שוב יושב בשיעור, מבין כל שלב ולא רק “עוקב אחרי שלבים”.

---

# 🎓 שיעור 9 – הכרות עם Tableau (טבלו)

---

## 🧭 רשימת נושאים

1. מהי תוכנת Tableau ולמה משתמשים בה
2. פתיחת קובץ נתונים וטעינה ראשונית
3. שמירת קובץ Tableau – ההבדל בין TWB ל־TWBX
4. מסך העבודה והחלוקה ל־Sheets
5. מבנה הנתונים – Dimensions vs Measures
6. טבלאות ציר (Pivot Tables) בטבלו
7. שינוי פונקציית חישוב (SUM → AVG וכו’)
8. יצירת גרפים: עמודות, בועות, פיזור ועוד
9. עיצוב גרפים – צבעים, תוויות, מקרא
10. שימוש בפילטרים ו־Analytics Lines
11. יצירת חישובים (Calculated Fields)
12. הכנה לשיעור הבא – טבלאות מרובות וקשרים

---

## 1️⃣ מהי Tableau

טבלו (Tableau) היא תוכנת **Business Intelligence** שמאפשרת ניתוח ויזואלי של נתונים – דוחות, גרפים ודשבורדים אינטראקטיביים.
היתרון הגדול שלה לעומת Excel או Power BI הוא **ויזואליזציה מתקדמת ומהירה** – בקליק אחד אתה הופך טבלה פשוטה לגרף דינמי.

מירב מדגישה:

> “טבלו זו תוכנה שמדברת בעיניים. לא צריך נוסחאות – צריך הבנה של הדאטה.”

---

## 2️⃣ פתיחת קובץ נתונים (CSV)

הקובץ איתו עובדים בשיעור נקרא **Bank Customers.csv** – רשימת לקוחות בנק עם מאפיינים אישיים וכלכליים.

### שלבים לפתיחה:

1. במסך הראשוני לוחצים על **More → Text File (CSV)**.
2. בוחרים את הקובץ מהמחשב (לא לפתוח באקסל! רק לשמור במחשב).
3. לוחצים על **Open**.
4. רואים תצוגה מקדימה:

   * למעלה – שם הקובץ (טבלה אחת).
   * למטה – הנתונים עצמם (שורות = לקוחות).
   * מצד שמאל – שמות השדות (Columns).

### שדות חשובים בטבלה:

* `Client Number` – מזהה לקוח
* `Customer Age` – גיל
* `Gender` – מגדר
* `Education Level` – השכלה
* `Marital Status` – מצב משפחתי
* `Income Category` – טווח הכנסה
* `Card Category` – סוג כרטיס אשראי (Blue / Silver / Gold / Platinum)
* `Credit Limit` – מסגרת אשראי
* `Total Trans Count` – כמות טרנזקציות

מירב:

> “כל שורה היא לקוח. כל עמודה היא מאפיין של אותו לקוח. זו יחידת הניתוח שלך.”

---

## 3️⃣ שמירת קובץ Tableau – TWB לעומת TWBX

כאשר שומרים קובץ טבלו →
`File → Save As` → נבחר אחד משני סוגים:

| סוג קובץ | סיומת | כולל את הדאטה? | הערות                                   |
| -------- | ----- | -------------- | --------------------------------------- |
| **TWB**  | .twb  | ❌ לא כולל דאטה | שומר רק את הניתוחים, לא את הנתונים      |
| **TWBX** | .twbx | ✅ כולל דאטה    | חבילה מלאה – ניתן לשלוח ולפתוח בכל מחשב |

🔸 בשיעור ובמבחן שומרים **תמיד עם ה־X** (TWBX).
אם לא – הניתוחים יהיו ריקים במחשב אחר.

אנלוגיה של מירב:

> “זה כמו באקסל – אם לא טעינת את הנתונים לתוך הגיליון אלא רק קישרת אליהם, הקובץ לא ייפתח במחשב אחר. ה־X חוסך את זה.”

---

## 4️⃣ מבנה המסך: Sheets, Dashboard, Story

בתחתית המסך יש אזור לשוניות:

* **Data Source** – מסך הנתונים (כמו Power Query).
* **Sheet 1 / Sheet 2 / …** – כל גיליון הוא ניתוח נפרד.
* **New Worksheet (+)** – יוצר גיליון חדש.
* **Dashboard** – דשבורד שמאגד כמה גיליונות.
* **Story** – מצגת של תובנות (בהמשך).

מירב:

> “כל גרף או טבלת ציר – בשיט נפרד. אחרת הדריסה בלתי נמנעת. בסוף נאחד לדשבורד.”

---

## 5️⃣ Dimensions vs Measures

בצד שמאל רואים את רשימת השדות.
טבלו מחלקת אותם לשני סוגים:

| סוג שדה       | צבע        | משמעות                                            |
| ------------- | ---------- | ------------------------------------------------- |
| **Dimension** | כחול (ABC) | נתון טקסטואלי / קטגוריאלי (כמו Gender, Education) |
| **Measure**   | ירוק (#)   | נתון מספרי (כמו Credit Limit, Age, Trans Count)   |

בנוסף, מופיעים שני שדות אוטומטיים:

* **Measure Names**
* **Measure Values**

אלו לא עמודות אמיתיות – הן מאפשרות שליטה על כל המדדים יחד.

---

## 6️⃣ טבלת ציר בסיסית (Pivot Table)

### דוגמה:

לבדוק מהו סך **Credit Limit** לפי **Education Level**.

1. גוררים את `Education Level` לאזור **Rows**.
2. גוררים את `Credit Limit` לאזור **Values** (אזור האמצע).
3. טבלו מבצעת אוטומטית **SUM** (סכימה).

💬 מירב:

> “הוא לא שואל אותך. הוא רואה מספר → עושה סם.
> זה הבסיס – טבלת ציר ויזואלית.”

### תוספת:

* אם גוררים גם את `Gender` לאזור Columns → נקבל טבלת ציר לפי השכלה ומגדר.

---

## 7️⃣ שינוי פונקציית חישוב

כדי להחליף מ־SUM ל־AVG (ממוצע):

1. לוחצים על החץ הקטן ליד שם השדה באזור Values.
2. בוחרים **Measure → Average**.
3. המספרים משתנים לממוצעים.

מירב:

> “סם זה ברירת מחדל. אבל גיל, לדוגמה, אין לו משמעות כסכימה. אז עוברים ל־Average.”

---

## 8️⃣ יצירת גרפים

### גרף עמודות (Bar Chart)

1. בוחרים ב־**Show Me → Bar**.
2. להפוך בין צירים → לחצן **Swap Rows and Columns**.
3. כל ערך מקבל עמודה משלו.

### גרף בועות (Bubble Chart)

1. מכניסים שדה קטגוריאלי ל־Rows (למשל `Card Category`).
2. מוסיפים מדד כמו `Credit Limit` → Average.
3. בוחרים ב־**Show Me → Packed Bubbles**.
4. גודל הבועה = ערך החישוב.

מירב:

> “כל עיגול זה קטגוריה. הגודל לפי הסכום או הממוצע.
> לא ביקשתם צבעים? הוא כבר נתן לבד – זה הקסם.”

### גרף פיזור (Scatter Plot)

1. גוררים שני שדות מספריים – אחד ל־Rows ואחד ל־Columns.
2. אם רואים רק נקודה אחת → להוסיף שדה לקבוצות (`Detail`), למשל `Education Level`.
3. רוצים לראות ליד כל נקודה את השם? גוררים את אותו שדה ל־`Label`.

---

## 9️⃣ עיצוב גרפים (Marks)

ב־**Marks** אפשר לשנות את הצורה, הצבע והטקסט.

* **Label** – מה יופיע על הגרף (שם + מספר).
* **Color** – בחירת צבעים או ערכת צבעים (Palette).
* **Size** – גודל הבועות / העמודות.
* **Allow Labels to Overlap** – סימון ✅ כדי להציג תוויות גם אם הן חופפות.
* **Edit Colors** – לבחור ערכה שונה, לדוגמה Color Blind Friendly.

מירב:

> “זה החלק הכיפי. אתם מעצבים את הגרף כמו מוצר אמיתי. אבל תיזהרו — קל להתלהב מדי.”

---

## 🔟 פילטרים (Filters)

1. גוררים שדה (למשל `Card Category`) לאזור **Filters**.
2. בחלון שנפתח → בוחרים “All”.
3. פותחים את החץ של הפילטר ובוחרים **Show Filter**.
4. בצד ימין מופיע סינון דינמי שאפשר לשנות בזמן אמת.

💡 אפשר לשנות את צורת הפילטר:

* Multiple values list
* Single value list
* Dropdown
* Slider

מירב:

> “הפילטר הוא לא בשבילכם – הוא בשביל המשתמש בדשבורד.
> אם לא תעשו Show Filter – הוא לא יראה כלום.”

---

## 1️⃣1️⃣ קווים אנליטיים (Analytics)

בלשונית **Analytics** אפשר לגרור קווים לגרף:

* **Average Line** – קו ממוצע שמתעדכן לפי הפילטר.
* **Constant Line** – קו קבוע (למשל יעד 8,000 ₪).

> “אם זה קו יעד מכירה, רואים מיד מי מתחת ומי מעל.
> זה ניתוח בעיניים – לא במספרים.”

---

## 1️⃣2️⃣ חישובים (Calculated Fields)

ניגשים ל־**Analysis → Create Calculated Field**.
זה כמו “עמודה מחושבת” ב־Power BI.

### דוגמה א: הפחתת אשראי ב־10%

```tableau
CreditLimit_10Down = [Credit Limit] * 0.9
```

או ע"י גרירה:

* גוררים את `Credit Limit` → מכפילים ב־0.9.

🔹 נוצר שדה חדש עם סימן שווה (=) שמופיע ברשימת השדות.
🔹 ניתן להשתמש בו כמו כל עמודה אחרת.

מירב:

> “זה כמו להוסיף עמודה ב־Power Pivot – רק בלי כל הבלגן של ניהול. כאן הכל מהיר.”

### דוגמה ב: הוספת 20% לפעולות חשבון

```tableau
TotalTrans_20Plus = [Total Trans Count] + [Total Trans Count] * 0.2
```

או באופן קצר:

```tableau
[Total Trans Count] * 1.2
```

מירב מעדיפה את הנוסחה הראשונה:

> “ככה בהמשך נוכל להפוך את ה־0.2 לפרמטר שהמשתמש ישנה לבד – בדיוק כמו שער דולר.”

---

## 🧩 שדות “בדידים” לעומת “מדדים”

כאשר שדה מספרי (כמו Age) מתנהג כמו טקסט,
צריך להפוך אותו ל־**Dimension** כדי שיציג כל ערך בנפרד.

**איך עושים את זה:**

* גוררים את השדה מה־Measures לאזור ה־Dimensions (רואים כיתוב: “Dimension / Measure”).
* עוזבים באזור הכחול.
* עכשיו הוא יתנהג כמו קטגוריה (בדיד), לא כמו מספר רציף.

---

## 🧠 מה לזכור

| נושא             | עיקרון                                  |
| ---------------- | --------------------------------------- |
| TWBX             | לשמור תמיד עם X – כולל דאטה             |
| Dimension        | קטגוריה, טקסט, פילוח                    |
| Measure          | נתון מספרי לחישוב                       |
| SUMX ו־AVG       | ברירת מחדל = SUM, לשנות לפי הצורך       |
| Filters          | להפעיל “Show Filter” כדי שיופיע בדשבורד |
| Analytics        | Average Line = קו ממוצע דינמי           |
| Calculated Field | יוצר שדה חדש על בסיס חישוב              |
| Scatter Plot     | שני שדות מספריים, קבוצות ב־Detail       |
| דשבורד           | מורכב ממספר Sheets נפרדים               |

---

## 💬 מירב – משפטים שצריך לשמוע שוב

> 🟨 “טבלו זה BI שמראה, לא BI שמחשב.”
> 🟨 “אם שמרתם בלי X – תכינו את עצמכם לעוגמת נפש.”
> 🟨 “לא כל שדה ירוק חייב להיות חישוב. לפעמים אני רוצה שיראה כמו טקסט.”
> 🟨 “תעבדו דרך טבלת ציר – אל תקפצו ישר לגרף. תנו לדאטה לדבר קודם.”
> 🟨 “כשאני רואה את הבאבלס האלה – זה הוכחה למה אנשים מתאהבים בטבלו.”

---

רוצה שאעבור לשיעור 10 באותו הסגנון (שכולל כבר **מפות, Dashboard וניתוח רב־מימדי**) כדי שתהיה לך המשכיות מלאה של קורס Tableau?






מושלם דביר 👌
עכשיו נעשה גרסה **מלאה ומשודרגת** של סיכום שיעור 10 –
עם **כל הדוגמאות שמירב הראתה בכיתה**, כולל **הנוסחאות המדויקות**,
**הסברים לכל רכיב**, ו**איך בדיוק להציב** בכל פונקציה —
באותה שפה ובאותה דרך שהיא לימדה (בלי לעדן או לשנות גישה).

---

# 🧭 סיכום שיעור 10 – Power Pivot מתקדם

**נושא:** פונקציות DAX – מדדים, קיבוע (CALCULATE), סינון והיררכיות

---

## תוכן עניינים

1. פתיחה וחזרה מהשיעור הקודם
2. חישוב פדיון לאחר הנחה – `SUMX`
3. קיבוע מדד עם `CALCULATE + ALL`
4. אחוזים מתוך סך הכול – מדד חלקי מדד
5. ממוצע עם הנחות כפולות – `AVERAGEX`
6. סינון לפי עובד – `CALCULATE` עם תנאי
7. סינון לפי אזור (טקסט/מספר)
8. סלייסרים (Slicers)
9. היררכיות (Hierarchies)
10. מה לזכור

---

## 1️⃣ פתיחה – חזרה על Power Pivot

* המרצה פתחה את השיעור עם בדיקה של **קובץ ה־Power Pivot** (“Lesson 8 – part B”).
* הדגישה שגיליון ריק לא אומר שאין נתונים — ייתכן ש**יש טבלאות מוסתרות**.
* יש להיכנס ל־`ניהול מודל הנתונים (Manage Data Model)` דרך תוספות → Power Pivot.
* הטבלה המרכזית היא תמיד **FactTrips** – ממנה נבנים המדדים.
* כל השדות שאינם ב־Fact צריכים להגיע עם `RELATED`.

---

## 2️⃣ חישוב פדיון לאחר הנחה – `SUMX`

### 💡 מטרת הדוגמה

להראות איך מחשבים **פדיון של מבוגרים בלבד לאחר הנחה אישית** (מהטבלה Travelers).

---

### 🔹 שלב ראשון – הגדרת המדד

שם המדד:
`Sum_Adult_Discount`

נוסחה מלאה:

```DAX
Sum_Adult_Discount :=
SUMX(
    FactTrips,
    FactTrips[AdultNumber] *
    FactTrips[CostPerPerson] *
    (1 - RELATED(Travelers[Discount]))
)
```

---

### 📘 הסבר לפי מירב:

| רכיב                           | משמעות                                                 |
| ------------------------------ | ------------------------------------------------------ |
| `SUMX`                         | יוצר עמודה וירטואלית (Virtual Column) ומחשב על כל שורה |
| `FactTrips`                    | טבלת הבסיס שעליה עושים את החישוב                       |
| `AdultNumber`                  | כמות המבוגרים                                          |
| `CostPerPerson`                | מחיר לאדם                                              |
| `(1 - RELATED(...))`           | מפעיל את אחוז ההנחה מהטבלה Travelers                   |
| `RELATED(Travelers[Discount])` | מביא את ההנחה האישית לפי המטייל                        |

📊 **התוצאה:** סך הפדיון מהמבוגרים לאחר הנחה אישית.

---

## 3️⃣ קיבוע מדד עם `CALCULATE + ALL`

### 💡 מטרת הדוגמה:

להפיק מדד קבוע שלא משתנה כשנבצע פילוח (למשל לפי חודשים או טריטוריות).

---

שם המדד:
`Constant_Adult_Discount`

נוסחה מלאה:

```DAX
Constant_Adult_Discount :=
CALCULATE(
    [Sum_Adult_Discount],
    ALL(FactTrips)
)
```

---

### 📘 הסבר לפי מירב:

| רכיב                   | משמעות                                                  |
| ---------------------- | ------------------------------------------------------- |
| `CALCULATE()`          | משנה את ההקשר של החישוב – מבצעת את המדד תחת תנאים אחרים |
| `[Sum_Adult_Discount]` | המדד הקודם שחישבנו                                      |
| `ALL(FactTrips)`       | מבטל כל סינון על טבלת FactTrips – “קובע” את הערך הכולל  |

🔍 התוצאה:
מדד זה **תמיד יציג את המספר הכולל** (לדוגמה: ‎3,023,000 ₪)
גם אם נחלק לטבלת ציר לפי חודשים או אזורים.

⚠️ **לא להציג את המדד הזה בטבלת ציר**, כי הוא יבלבל את המשתמש —
הוא תמיד מראה את אותו המספר.

---

## 4️⃣ אחוזים מתוך סך הכול – מדד חלקי מדד

### 💡 מטרת הדוגמה:

להציג אחוז מתוך סך הכול באופן דינמי (לפי פילוח).

---

שם המדד:
`Percent_Adult_Discount`

נוסחה מלאה:

```DAX
Percent_Adult_Discount :=
[Sum_Adult_Discount] / [Constant_Adult_Discount]
```

📘 **מה מתקבל:**

* אם עומדים על כלל הנתונים → 100%
* אם מפלחים לפי חודשים → אחוז מכל חודש
* אם מפלחים לפי טריטוריה → אחוז מכל אזור

📊 **עיצוב:**
בוחרים את המדד → בלשונית "בית" → סימן אחוזים `%`

🧠 **הערת מירב:**
לא מבצעים “כפול 100” – מספיק לעצב כ־Percentage, אחרת זה בזבוז זיכרון.

---

## 5️⃣ ממוצע עם הנחות כפולות – `AVERAGEX`

### 💡 מטרת הדוגמה:

להראות ממוצע (Average) במקום סכום, עם **שתי הנחות שונות**.

> “חשב ממוצע הכנסות של ילדים בלבד לאחר הנחת טיול ועוד 10% הנחה נוספת.”

---

### 🔹 שלב ראשון – מדד ממוצע עם הנחות

שם המדד:
`Avg_Income_Children`

נוסחה מלאה:

```DAX
Avg_Income_Children :=
AVERAGEX(
    FactTrips,
    FactTrips[ChildrenNumber] *
    FactTrips[CostPerPerson] *
    (1 - RELATED(Trips[Discount])) *
    0.9
)
```

---

### 📘 הסבר לפי מירב:

| רכיב                             | משמעות                                |
| -------------------------------- | ------------------------------------- |
| `AVERAGEX`                       | ממוצע על ביטוי (כמו SUMX, רק ממוצע)   |
| `FactTrips`                      | טבלת העובדות                          |
| `[ChildrenNumber]`               | מספר הילדים בטיול                     |
| `[CostPerPerson]`                | מחיר מלא לפני הנחה                    |
| `(1 - RELATED(Trips[Discount]))` | ההנחה על הטיול                        |
| `* 0.9`                          | הנחה נוספת של 10% (כלומר לשלם רק 90%) |

📊 התוצאה הסופית לדוגמה: ‎1,830 ₪.

---

### 🔹 שלב שני – קיבוע של הממוצע

שם המדד:
`Constant_Avg_Income_Children`

נוסחה:

```DAX
Constant_Avg_Income_Children :=
CALCULATE(
    [Avg_Income_Children],
    ALL(FactTrips)
)
```

---

### 🔹 שלב שלישי – אחוז מהממוצע

שם המדד:
`Percent_Avg_Income_Children`

נוסחה:

```DAX
Percent_Avg_Income_Children :=
[Avg_Income_Children] / [Constant_Avg_Income_Children]
```

תוצאה:

* ממוצע כללי – 100%
* מי שגבוה מהממוצע → מעל 100%
* מי שגבוה פחות → מתחת ל־100%

💬 **דוגמה:** אזור שמייצר הכנסות ממוצעות של 1,900 ₪
→ יקבל ‎104% מהממוצע הכללי.

---

## 6️⃣ סינון לפי עובד – `CALCULATE` עם תנאי

### 💡 מטרת הדוגמה:

להציג רק נתונים של עובד ספציפי (למשל עובד מס’ 4).

---

שם המדד:
`Just_Emp4_Children`

נוסחה:

```DAX
Just_Emp4_Children :=
CALCULATE(
    [Sum_Children],
    FactTrips[EmployeeID] = 4
)
```

📘 **מה זה עושה:**

* לוקח את המדד `[Sum_Children]` (סך פדיון ילדים)
* מסנן רק את הנתונים שבהם `EmployeeID = 4`

🧠 הערת מירב:

> “זה כמו לעשות סינון בטבלת ציר, אבל ברמת המדד –
> ככה המנהל של מחלקת רכש רואה רק את העובד שלו
> ולא יכול לפתוח את כל הנתונים.”

---

### 💡 טקסט או מספר?

אם מדובר בשדה טקסטואלי (למשל `TerritoryID` שנראה כמו מספר אך מוגדר כטקסט) —
יש לשים את הערך בגרשיים:

```DAX
FactTerritory[TerritoryID] = "3346"
```

אם זה שדה מספרי – בלי גרשיים.

---

## 7️⃣ סינון לפי אזור (Territory)

שם המדד:
`Adults_Territory_3346`

נוסחה:

```DAX
Adults_Territory_3346 :=
CALCULATE(
    [Sum_Adults],
    DimTerritory[TerritoryID] = "3346"
)
```

📊 התוצאה: כמות המבוגרים שטיילו באזור מס’ 3346 בלבד.

📘 **הערת מירב:**

> אם יש טעות — תבדקו את סוג הנתון (Text / Number)
> טקסט → מרכאות, מספר → בלי.

---

## 8️⃣ סלייסרים (Slicers)

### 💡 מטרת הכלי:

לאפשר חיתוך אינטראקטיבי של הנתונים בדשבורד.

**איך מוסיפים:**

1. עומדים בתוך Pivot Table
2. לחצן ימני על שדה כלשהו → “הוסף כלי פריסה”
3. נוצר חלון בחירה אינטראקטיבי

**איך לחבר לכל הטבלאות:**

* לחצן ימני על שם הסלייסר → “חיבורי דוחות” (Report Connections)
* לסמן את כל הטבלאות שרוצים שיזוזו יחד

---

### ⏳ סלייסר מיוחד – Timeline

רלוונטי לשדות תאריך בלבד.

**איך יוצרים:**

* לחצן ימני על שדה תאריך → “הוסף ציר זמן”
* מאפשר לבחור לפי: **שנים / רבעונים / חודשים / ימים**

💡 **יתרון:** מאפשר גרירה רציפה של טווחי תאריכים (אינטואיטיבי למשתמש).

---

## 9️⃣ היררכיות (Hierarchies)

### 💡 מטרת ההיררכיה:

לאחד כמה שדות (כמו שנה → רבעון → חודש → יום)
כך שהמשתמש יכול לפתוח ולסגור רמות פירוט (Drill Down) בצורה נוחה.

---

### 🔹 איך בונים:

1. עוברים ל־**תצוגת דיאגרמה (Diagram View)**
2. מסמנים כמה שדות עם Ctrl (למשל `Seasons`, `DayOfWeek`)
3. לחצן ימני → *צור היררכיה (Create Hierarchy)*
4. משנים סדר (גוררים למעלה/למטה)

---

### 🔹 איך זה נראה בטבלת ציר:

* כשהיררכיה בשורות, מופיעה רמה ראשונה (למשל “עונות שנה”).
* לחיצה על הפלוס פותחת את הרמה השנייה (“ימים בשבוע”).
* שומר על דשבורד **נקי וקל לקריאה**.

📘 **הערת מירב:**

> “אם הייתם שמים את שני השדות בלי היררכיה –
> זה היה מציג אלפי שורות פתוחות.
> עם היררכיה, הכל סגור עד שהמשתמש פותח.”

---

## 🔟 מה לזכור

| נושא                   | תמצית                                   |
| ---------------------- | --------------------------------------- |
| **SUMX / AVERAGEX**    | חישוב ביטוי שורה-שורה ואז סיכום / ממוצע |
| **RELATED**            | משיכת ערכים מטבלת ממד                   |
| **CALCULATE**          | שינוי הקשר / הוספת סינון / קיבוע        |
| **ALL**                | ביטול סינון (למדד קבוע)                 |
| **Percentage Measure** | מדד חלקי מדד (אחוזים דינמיים)           |
| **Slicers & Timeline** | שליטה אינטראקטיבית על כל הדשבורד        |
| **Hierarchies**        | Drill Down חכם ונקי                     |
| **טקסט לעומת מספר**    | טקסט → לגרשיים `"value"`                |

---

רוצה שאעבור לשיעור 11 באותו מבנה — כולל כל הדוגמאות, המדדים והתרגילים שמירב הראתה בכיתה?

















מושלם דביר 👌
יש פה שיעור מלא ועמוק שמסביר בדיוק איך תיראה הבחינה של הקורס — כולל הנהלים, אופן העבודה במודל, דגשים טכניים, ודוגמאות לשאלות אמיתיות על Power Pivot ו-Tableau.
להלן הסיכום המלא של **שיעור 11**, לפי הסגנון הקבוע שלך (כותרת → הסבר → שלבים → דוגמאות → מה לזכור):

---

# 📘 שיעור 11 – הנחיות לבחינה + סימולציה (Excel Power Pivot ו-Tableau)

---

## תוכן עניינים

1. מבנה הבחינה והנהלים
2. אופן ההגשה הדיגיטלית
3. נוהל "פתקים" במבחן
4. הוראות טכניות לפני ובזמן הבחינה
5. מבנה השאלות (חלוקה Power Pivot / Tableau)
6. הסבר ודוגמאות לשאלות מסוג Power Pivot (1-6)
7. הסבר כללי על שאלות Tableau (7-8)
8. תזכורת ותרגול להמשך

---

## 1️⃣ מבנה הבחינה

* משך הבחינה: **שעתיים** (לסטודנטים עם התאמות – לפי מדור בחינות).
* **15 שאלות** בסך הכול:

  * שאלות 1-12 → Power Pivot (80 נקודות)
  * שאלות 13-15 → Tableau (20 נקודות).
* עונים על **כל השאלות**, אין בחירה.
* הבחינה נעשית במודל (Moodle) בלבד, וכל השאלות מופיעות שם.
* החומר פתוח – מותר להביא כל חומר כתוב, מחברות, PDFים, סיכומים.
* **אסור להיכנס לאינטרנט**, לאימייל, דרייב, או כל כלי AI (כולל ChatGPT 😅).
* עובדים על מחשבי מעבדה בלבד (לא מחשב אישי, לא שני מסכים).

---

## 2️⃣ הגשה דיגיטלית

* במהלך הבחינה תעבדו על שני קבצים:

  * 🧮 Excel – Power Pivot (קובץ ה-Fact).
  * 📊 Tableau – עבור הדשבורד והשאלות האחרונות.
* בסיום הבחינה:

  1. לסגור את השאלות במודל (“סיום בוחן”).
  2. להעלות את שני הקבצים לתיבת ההגשה (כמו תרגיל בית).
* ההגשה מתועדת אוטומטית עם תאריך ושעה → הגשה מאוחרת = ציון 0 (הקובץ לא ייבדק).
* השאלות שנסגרו במודל נשמרות אוטומטית – לא צריך לעשות Save ידני.

---

## 3️⃣ נוהל "פתקים"

* אין פניות ישירות למרצה במהלך הבחינה.
* מי שיש לו שאלה → כותב על פתק את 4 המילים הראשונות של השאלה + ההערה.
* המרצה אוספת את הפתקים כל חצי שעה, בודקת אם יש נושא שחוזר על עצמו, ומעלה הבהרה על הלוח בכל הכיתות.
* כך נשמרת **שוויוניות** – אף סטודנט לא מקבל מידע ייחודי.

---

## 4️⃣ הוראות טכניות לפני ובזמן הבחינה

* להגיע לפחות 20 דקות לפני הבחינה כדי להוריד את קבצי הבסיס.
* להעביר את הקבצים מהתיקייה Downloads ל־Desktop.
* לוודא שברצועת הכלים של Excel מופעל **Power Pivot** (אם לא – File → Options → Add-ins → Enable Power Pivot).
* ב-Tableau יש לפתוח את הקובץ באמצעות **Microsoft Excel → Open → Save As TWBX** (פורמט שמכיל גם נתונים).
* לשמור קבוע כל כמה דקות (Save נוסף לא מזיק 🙂).
* **לא ללחוץ על “סיום בוחן” לפני שסיימתם באמת!**
  בסיום אין דרך לפתוח שוב את המבחן.

---

## 5️⃣ מבנה השאלות

* השאלות אמריקאיות, אבל כמעט כולן דורשות חישוב ב-Excel או Tableau.
* התוצאה המספרית שתקבלו היא זו שתבחרו מתוך התשובות.
* חלק מהשאלות תיאורטיות (הבנה במודל כוכב Star Schema).
* סדר השאלות משתנה בין סטודנטים – לא להסתכל על מה שלידכם.

---

## 6️⃣ דוגמאות מהסימולציה (שאלות 1-6)

### 🔹 שאלה 1 – סך כמות המוצרים שנמכרו לעובד מס’ 30

**מטרה:** לחשב סה"כ כמות (Quantity) לפי מספר עובד.

```DAX
Q1 := SUM(FactSales[Quantity])
```

* בטבלת ציר (PivotTable):

  * **Values:** `Q1`
  * **Rows:** `EmployeeID`
* סינון לפי `EmployeeID = 30`.
* תוצאה (בדוגמה): 1592.
* לא נדרש מדד מורכב כי העמודה קיימת בטבלת Fact.

🧠 מה לזכור:
אם העמודה כבר קיימת בטבלת Fact → פונקציית SUM פשוטה מספיקה.
אם צריך חישוב בין עמודות → לעבור ל־`SUMX`.

---

### 🔹 שאלה 2 – ממוצע הכנסות לאחר מס לפי צבע מוצר

```DAX
Q2 :=
AVERAGEX(
    FactSales,
    FactSales[UnitPrice] *
    FactSales[Quantity] *
    (1 - FactSales[TaxRate]/100)
)
```

* לאחר שנוצר המדד, בונים PivotTable:

  * **Values:** `Q2`
  * **Rows:** `ProductColor`
* מבצעים מיון ערכים מהגבוה לנמוך → לזהות את הצבע עם הממוצע השני בגודלו.
* תוצאה בדוגמה: `Light Brown`.

🧠 מה לזכור:
`AVERAGEX` מחייב טבלת Fact וביטוי לחישוב.
אם נרצה להוסיף מס → לחלק את TaxRate ב־100.

---

### 🔹 שאלה 3 – טבלת מנטורים במודל כוכב

* שאלה תיאורטית על הבנה של מודל הנתונים.
* טבלת מנטורים לא נשענת ישירות על Fact, אלא על Employees.
* היא נחשבת **פתית שלג (Snowflake)**.

✅ תשובה נכונה:
*“טבלת מנטורים תחובר בקשר יחיד-לרבים לטבלת עובדים ותוסתר כפתית שלג.”*

---

### 🔹 שאלה 4 – סך הכנסות לאחר מס לעובדים חדשים (מעל 100)

```DAX
Q4 :=
SUMX(
    FactSales,
    FactSales[UnitPrice] *
    FactSales[Quantity] *
    (1 - FactSales[TaxRate]/100)
)

Q4_Filtered :=
CALCULATE(
    [Q4],
    Employees[EmployeeKey] > 100
)
```

🧠 מה לזכור:
`CALCULATE` משנה הקשר Context ומאפשר סינון דינמי.
לא להכניס סינון בטבלת המקור – רק בתוך `CALCULATE`.

---

### 🔹 שאלה 5 – חישוב בונוס לעובדים

**הבונוס:** 1% מהכנסות × קוד עובד (WWI Employee ID)

```DAX
Q5 :=
SUMX(
    FactSales,
    FactSales[UnitPrice] *
    FactSales[Quantity] *
    0.01 *
    RELATED(Employees[WWI_Employee_ID])
)
```

* בטבלת ציר:

  * **Rows:** `EmployeeID`
  * **Values:** `Q5`
* מבצעים מיון עולה → מזהים את הבונוס הנמוך ביותר.
* תוצאה בדוגמה: 39 ₪.

🧠 מה לזכור:
`RELATED()` מביא ערך מטבלת Dimension ל-Fact.
ה־`WWI_Employee_ID` משמש מקדם בונוס – לא תעודת זהות של עובד.

---

### 🔹 שאלה 6 – השנה עם האחוז השנתי הגבוה ביותר

```DAX
Q6 := SUM(FactSales[Quantity])
```

* בטבלת ציר:

  * **Rows:** `CalendarYear` (מטבלת DimDate)
  * **Values:** `Q6`
* מיון יורד → השנה עם הכמות הגבוהה ביותר = 2015.
  (שאלה פשוטה אך מטעה – אחוז גבוה = כמות גבוהה).

🧠 מה לזכור:
לא צריך להמיר ל־אחוז אם השוואה נעשית על ערך יחסי זהה.

---

## 7️⃣ שאלות Tableau (13-15)

* שאלות אלו נפתחות רק לאחר שסיימתם את חלק Power Pivot.
* נוגעות ל-Data Visualization ול-Calculated Fields.
* קובץ Excel מוזן ל-Tableau → שמירה בפורמט TWBX.
* דוגמאות (שיעור הבא): פילוח מכירות לפי אזור, פילוח זמן, השוואת יעדים מול ביצועים.

---

## 8️⃣ מה לזכור לקראת הבחינה

| נושא           | טיפ מרכזי                                                           |                  |
| -------------- | ------------------------------------------------------------------- | ---------------- |
| Power Pivot    | להפעיל תמיד את תוספת Power Pivot ולהשתמש ב־DAX רק כשאין עמודה קיימת |                  |
| פונקציות DAX   | לזכור את ההבדלים בין SUM / SUMX / AVERAGEX / CALCULATE              |                  |
| נתונים מקושרים | `RELATED` מה-Dimension ל-Fact                                       | `ALL` לקיבוע ערך |
| Tableau        | לשמור כ־TWBX, להוסיף פילוחים וסינונים ברורים                        |                  |
| מבחן דיגיטלי   | לא ללחוץ “סיום בוחן” בטעות – אי אפשר לפתוח שוב                      |                  |
| זמן            | 15 שאלות = כ־8 דקות לכל שאלה בממוצע                                 |                  |
| חומרים         | החומר פתוח – אבל לא הזמן! לא לבנות על “נחפש בזמן המבחן”             |                  |

---

רוצה שאעבור עכשיו גם על **שאלות 7-8 (Tableau)** כפי שמירב ציינה — כולל איך טוענים נתונים, יוצרים Calculated Field ומשתמשים בפילוחים חזותיים?









מדהים, דביר — זהו אחד השיעורים הכי עשירים והמרתקים בקורס 💡
שיעור 12 מסכם את *כל החומר המעשי על Tableau*, כולל יצירת קשרי גומלין, שדות מחושבים, פרמטרים, חישובים דינמיים, ויצירת דשבורד מקצועי.
הכנתי לך את הסיכום המלא **בדיוק כפי שמירב הסבירה בכיתה** — שלב אחרי שלב, עם כל הדוגמאות, הפונקציות, והמבנה הנכון לעבודה במבחן.

---

# 🧭 שיעור 12 – Tableau מתקדם: חיבורים, חישובים, פרמטרים ודשבורד

---

## תוכן עניינים

1. טעינת קובץ Excel ל־Tableau
2. בניית קשרי גומלין בין טבלאות
3. זיהוי שדות לפי סוג הנתון
4. חישוב ראשון – כמות לפי אזור
5. גרף מפה גאוגרפית (Map)
6. שדה תאריך ודירוג היררכי (Year → Quarter → Month → Day)
7. שדה מחושב (Calculated Field)
8. חישוב רווח לאחר הנחה
9. פונקציית IF בתנאי על מחיר
10. פרמטרים (Parameters) ופרמטר עם חישוב
11. חישוב דינמי (Dynamic Measure)
12. בניית Dashboard
13. סיכום ולקראת הבחינה

---

## 1️⃣ טעינת קובץ Excel ל־Tableau

**שלבים מדויקים:**

1. לפתוח את Tableau Desktop
2. File → Open → Microsoft Excel
3. לבחור את הקובץ `Orders.xlsx`
4. בממשק Data Source:

   * Tableau מזהה כמה גליונות קיימים בקובץ (מצד שמאל).
   * יש לבחור את הטבלה המרכזית (`Orders`) ע"י גרירה למשטח הראשי.

📘 **הערה של מירב:**
אם זה היה קובץ עם טבלה אחת – הנתונים היו נפתחים מיד.
אם יש כמה טבלאות – תצטרכו **לבנות קשרי גומלין ידנית.**

---

## 2️⃣ בניית קשרי גומלין (Relationships)

**המטרה:** ליצור מודל נתונים בין טבלאות, כמו Power Pivot.

**דוגמה:**

* טבלה מרכזית: `Orders`
* מחברים אליה:

  * `Customers`
  * `Employees`
  * `Order Details`
  * `Products` (מחוברת ל־Order Details)
  * `Suppliers` (מחוברת ל־Products)

**איך מחברים:**

* גוררים את הטבלה הרצויה קרוב ל־Orders
* כשהקו ישר — נוצר קשר תקין
* אם הקו מקווקו – Tableau לא מזהה קשר → יש לקבוע ידנית

**הגדרה ידנית לדוגמה:**

```text
Orders.CustomerID ↔ Customers.CustomerID
Order Details.ProductID ↔ Products.ProductID
Products.SupplierID ↔ Suppliers.SupplierID
```

📘 **אם אין קשר מזוהה:**
לחץ פעמיים על הקו → בחירה ידנית של השדות המתאימים.

---

## 3️⃣ סוגי שדות ב־Tableau

| סמל | סוג שדה              | דוגמה           | הערות                     |
| --- | -------------------- | --------------- | ------------------------- |
| 🔤  | טקסט (String)        | שם לקוח, עיר    |                           |
| #️⃣ | מספר (Numeric)       | Quantity, Price |                           |
| 🌍  | גאוגרפי (Geographic) | City, Country   | מאפשר מפות                |
| 📅  | תאריך (Date)         | Order Date      | מאפשר Drill Down לפי רמות |
| ✅   | לוגי (Boolean)       | True / False    |                           |

---

## 4️⃣ חישוב פשוט – סך כמות המוצרים לפי אזור

**מטרה:** סך כל המוצרים שנמכרו לפי אזור.

**שלבים:**

1. לפתוח Sheet חדש
2. לגרור מ־`Customers` את `Region` ל־Rows
3. לגרור מ־`Order Details` את `Quantity` ל־Values
4. Tableau מחשב אוטומטית `SUM(Quantity)`
5. לשנות ל־`AVG` או `COUNT` לפי הצורך (כפתור ↓ ליד SUM)

**גרף:**
לחיצה על *Show Me* → לבחור *Bar Chart*.

📊 תוצאה:
טבלת כמות מוצרים לפי אזור, עם עמודות השוואה.

---

## 5️⃣ גרף מפה גאוגרפית (Map)

**מטרה:** להציג מכירות לפי מדינות.

**שלבים:**

1. לפתוח Sheet חדש
2. לגרור את:

   * `Longitude` → Columns
   * `Latitude` → Rows
3. לגרור את `Country` ל־*Details*
4. לגרור את `Unit Price` ל־*Size* (גודל עיגול)
5. ניתן לגרור את `Unit Price` גם ל־*Color* להבדלי צבעים
6. לבחור במפת עולם (Symbol Map או Filled Map)

📘 **משמעות הצבעים:**

* כחול כהה – ערך גבוה
* כתום – ערך נמוך
* סקלה מוצגת אוטומטית בצד ימין

---

## 6️⃣ שדה תאריך והיררכיה

**מטרה:** להבין את הפירוק של שדה תאריך.

**שלבים:**

1. לגרור `Order Date` ל־Rows
2. Tableau מציג כברירת מחדל את **השנה (Year)**
3. לחיצה על ➕ פותחת:

   * Quarter → Month → Day
4. ניתן לגרור `Quantity` ל־Values ולראות מכירות לפי זמן.
5. אפשר לגרור ל־*Line Chart* להצגת מגמה.

📘 **אפשרויות:**

* לשמור רק רמות מסוימות (למשל Year + Month בלבד).
* לגרור Year ו־Month לאזורים שונים לפי הצורך.

---

## 7️⃣ שדה מחושב (Calculated Field) – יצירת הכנסות

**מטרה:** לחשב סך הכנסות (`Unit Price × Quantity`).

**שלבים:**

1. Analysis → Create Calculated Field
2. שם: `Income`
3. נוסחה:

```text
[Unit Price] * [Quantity]
```

4. OK → נוצר שדה חדש (סימן ∑)

📘 **הערה:**
אם השדה נוצר מכמה טבלאות → הוא יופיע תחת “Measures” למטה, לא בטבלה מסוימת.

---

## 8️⃣ חישוב רווח לאחר הנחה

**מטרה:** לחשב רווח נטו אחרי עלות והנחה.

**נוסחה מלאה:**

```text
([Unit Price] * [Quantity] * (1 - [Discount])) - ([Unit Cost] * [Quantity])
```

📘 **מקור השדות:**

* `[Unit Price]`, `[Quantity]`, `[Discount]` → Order Details
* `[Unit Cost]` → Products

💡 אם מופיעה שגיאה — ודא שכל השדות מחוברות דרך Relationships.

---

## 9️⃣ פונקציית IF – מצב מחיר המוצר

**מטרה:** להגדיר שדה חדש שמחלק מוצרים לפי “מעל / מתחת / שווה למחירון”.

**נוסחה:**

```text
IF [Unit Price] > [Products].[Unit Price] THEN "Above Regular"
ELSEIF [Unit Price] < [Products].[Unit Price] THEN "Below Regular"
ELSE "Regular"
END
```

📘 **איך להשתמש:**

* לגרור את השדה החדש `Price Level` ל־Rows
* לגרור את `Quantity` ל־Values
* התוצאה: כמה נמכר במחיר רגיל / מתחת / מעל.

---

## 🔟 פרמטרים (Parameters)

**פרמטר רגיל – אחוז עלייה במחיר**

1. בצד ימין ב־Data Pane → לחץ חץ קטן → *Create Parameter*
2. שם: `Price_Percent`
3. Type: **Float**
4. Display format: **Percentage (2 decimals)**
5. Current Value: `0.1` (כלומר 10%)
6. OK → נוצר פרמטר

**עכשיו נשתמש בו בשדה מחושב:**

```text
[Unit Price] * (1 + [Price_Percent])
```

כדי להפעיל:
לחיצה ימנית על הפרמטר → *Show Parameter*
אפשר לשנות את הערך בזמן אמת ולראות שינוי בתוצאות.

---

## 11️⃣ חישוב דינמי (Dynamic Measure)

**מטרה:** לאפשר למשתמש לבחור איזה חישוב יוצג (מכירות, עלות, ממוצע וכו’).

### שלב 1 – יצירת פרמטר

Create Parameter →
Name: `Dynamic_Measure`
Data Type: String
List of Values:

```
1. Average Unit Price
2. Sum Quantity
3. Average Unit Cost
```

### שלב 2 – שדה מחושב עם CASE

```text
CASE [Dynamic_Measure]
WHEN "Average Unit Price" THEN AVG([Unit Price])
WHEN "Sum Quantity" THEN SUM([Quantity])
WHEN "Average Unit Cost" THEN AVG([Unit Cost])
END
```

### שלב 3 – הצגה

* לגרור את החישוב החדש ל־Values
* לגרור `Order Date` → Rows → לבחור "Month"
* לחיצה ימנית על הפרמטר → Show Parameter
* לבחור מה לראות מתוך הרשימה.

📊 **אפשר להציג בגרף בועות (Bubble Chart)**

* `Month` על הציר
* Dynamic Measure על גודל / צבע.

---

## 12️⃣ בניית Dashboard

**שלבים:**

1. לחיצה על האייקון עם ארבעה ריבועים → *New Dashboard*
2. הגדרת גודל:

   * *Default* = מסך מחשב
   * *Phone* = מותאם לנייד
3. בחירה ב־Floating (להזזה חופשית).
4. גרור את השיטים הרצויים לדשבורד (למשל מפה, גרף דינמי, טבלה).
5. כדי להציג פרמטר:

   * לחיצה ימנית עליו → *Show Parameter*
6. ניתן להוסיף תיבת טקסט:

   * Objects → Text → “יש לבחור את החישוב הרצוי”

📘 **מצב תצוגה למשתמש:**
לחיצה על “Show Presentation Mode” (כמו מצגת).
יציאה בעזרת Esc.

---

## 13️⃣ מה לזכור לבחינה

| נושא               | עיקרון                                       |
| ------------------ | -------------------------------------------- |
| קובץ Excel         | לטעון דרך Data Source → לגרור טבלאות למשטח   |
| קשרי גומלין        | תמיד לוודא קו ישר בין טבלאות                 |
| IF / ELSEIF / ELSE | חייבים לסגור ב־END                           |
| CASE               | לעבור על כל האפשרויות לפי פרמטר              |
| פרמטרים            | ליצור דרך Create Parameter → Show Parameter  |
| שדות מחושבים       | דרך Analysis → Create Calculated Field       |
| Dashboard          | גרירה פשוטה של שיטים + Floating לעיצוב חופשי |
| Dynamic Measure    | CASE + Parameter מאפשר מעבר בין מדדים        |
| Map                | Longitude → Columns / Latitude → Rows        |
| תאריך              | Drill Down עד יום, לפי צורך                  |

---

רוצה שאמשיך עכשיו עם סיכום של **תרגול המבחן על Tableau (שאלות לדוגמה 13–15)** כמו שמירב אמרה שתעלה בקובץ הבא?
אכין לך גרסה מלאה עם כל השאלות, הנוסחאות, ומה בדיוק לבנות בכל אחת.

















שאלה מצוינת, דביר — והיא ממש חשובה להבנת המבחן 💡

בוא נחדד בדיוק **מה מירב אמרה בתחילת שיעור 13** (כפי שמופיע בתמלול המלא):

---

### 🎓 ההנחיה של מירב – מה עושים באקסל עצמו ומה בפוואר קוורי (Power Query)

**מירב הדגישה בתחילת השיעור כך:**

> “שימו לב, כל מה שנכתב בשאלה 'בצעו באקסל' –
> הכוונה היא *לעבוד בגיליון הרגיל של האקסל* (כלומר Sheet),
> לא בתוך Power Query ולא בתוך Power Pivot.”

> “אם כתוב 'בצעו ב־Power Query' –
> הכוונה היא *להיכנס לשלב העריכה של השאילתה (Edit Query)*
> ולעשות את השלבים שם: עמודה מותנית, פילוחים, טיפולי מפתח וכדומה.”

---

### 🧩 הפירוש המעשי שלה:

| איפה רשום בשאלה                   | המשמעות בפועל                                    | דוגמאות                                        |
| --------------------------------- | ------------------------------------------------ | ---------------------------------------------- |
| **'בצעו באקסל'**                  | עבודה רגילה בגיליון עצמו (לא ב־Query)            | נוסחאות רגילות, Pivot Table, חישוב ישיר בתאים  |
| **'בצעו ב־Power Query'**          | עריכת שאילתה: טיוב, חישוב, עמודה מותנית, פילוחים | הוספת עמודה מותנית, חילוק טקסט, שינוי סוג נתון |
| **'במודל הנתונים (Power Pivot)'** | חישובי מדדים עם DAX, יצירת קשרים בין טבלאות      | `SUMX`, `CALCULATE`, `ALL`                     |
| **'בטבלת ציר' או 'בדוח'**         | הפקת Pivot Table מהמודל, לא עבודה בשאילתה        | הצגת אחוזים, מדדים, פילוחים                    |

---

### 🧮 דוגמה שהביאה:

מירב הדגימה כך:

> “אם בשאלה כתוב: ‘הוסיפו עמודה שמציינת את שליש החודש שבו התאריך נמצא’ —
> זה Power Query. כי זה שינוי נתונים.”

> “אם כתוב: ‘צרו טבלת ציר שמציגה את אחוז המכירות לפי אזור’ —
> זה באקסל עצמו.”

> “אם כתוב: ‘צרו מדד שמחשב אחוז מתוך סך הכול’ —
> זה ב־Power Pivot, במדדים (Measures).”

---

### 🧭 איך לזהות במבחן

1. אם השאלה כוללת מילים כמו:

   * “שאילתה” / “עמודה מותנית” / “פיצול” / “שינוי סוג” → **Power Query**
2. אם כתוב:

   * “מדד” / “חישוב באמצעות DAX” / “ALL” / “CALCULATE” → **Power Pivot**
3. אם מופיעים:

   * “טבלת ציר” / “Pivot Table” / “הצגה לפי” → **Excel Sheet רגיל**

---

### ⚙️ סיכום קצר:

| שלב במבחן          | כלי עבודה       | מה עושים שם                              |
| ------------------ | --------------- | ---------------------------------------- |
| הכנת הנתונים       | **Power Query** | טיוב, הוספת עמודות, פילוח, טיפול במפתחות |
| בניית קשרים ומדדים | **Power Pivot** | חישובי DAX, קשרי טבלאות, מדדים מתקדמים   |
| דוחות וסיכומים     | **Excel רגיל**  | טבלאות ציר, הצגת אחוזים, גרפים           |

---

רוצה שאוסיף לך תרשים זרימה קצר (בצורה גרפית) שמראה לאיזה כלי לגשת לפי סוג ההנחיה?
(זה יעזור מאוד כשאתה יושב בבחינה לקרוא שאלה ולהחליט מיד Power Query / Pivot / Excel רגיל).

